{"remainingRequest":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/thread-loader/dist/cjs.js??ref--4-2!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/babel-loader/lib/index.js??ref--4-3!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/source-map-loader/index.js!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/eslint-loader/dist/cjs.js!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/user/UserPermission/edit-permission.js","dependencies":[{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/user/UserPermission/edit-permission.js","mtime":1621607237508},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/react-hot-loader/webpack.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/source-map-loader/index.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmICh0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkoYXJyKTsgfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJ1bmRlZmluZWQiIHx8ICEoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSkgcmV0dXJuOyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgppbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnOwppbXBvcnQgeyBDQnV0dG9uLCBDQ2FyZCwgQ0NhcmRIZWFkZXIsIENDYXJkQm9keSwgQ0NvbCwgQ0Zvcm0sIENJbnZhbGlkRmVlZGJhY2ssIENGb3JtR3JvdXAsIENMYWJlbCwgQ0lucHV0LCBDUm93LCBDQ2FyZFRpdGxlLCBDSW5wdXRDaGVja2JveCwgQ0J1dHRvbkdyb3VwLCBDVGV4dGFyZWEgfSBmcm9tICdAY29yZXVpL3JlYWN0L2xpYic7CmltcG9ydCBDSWNvbiBmcm9tICdAY29yZXVpL2ljb25zLXJlYWN0L2xpYi9DSWNvbic7CjsKaW1wb3J0IHsgRm9ybWlrIH0gZnJvbSAnZm9ybWlrJzsKaW1wb3J0ICogYXMgWXVwIGZyb20gJ3l1cCc7CmltcG9ydCB7IHVzZURpc3BhdGNoLCB1c2VTZWxlY3RvciB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgZ2V0RGV0YWlsUGVybWlzc2lvbkdyb3VwcywgZ2V0UGVybWlzc2lvbnMsIGdldFBlcm1pc3Npb25UeXBlLCB1cGRhdGVQZXJtaXNzaW9uR3JvdXBzIH0gZnJvbSAnLi9wZXJtaXNzaW9uLmFwaSc7CmltcG9ydCB7IHVzZUhpc3RvcnkgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJzsKaW1wb3J0IHsgZmV0Y2hpbmcsIGdsb2JhbGl6ZWRQZXJtaXNzaW9uR3JvdXBzU2VsZWN0b3JzLCByZXNldCB9IGZyb20gJy4vcGVybWlzc2lvbi5yZWR1Y2VyJzsKaW1wb3J0IFNlbGVjdCBmcm9tICdyZWFjdC1zZWxlY3QnOwppbXBvcnQgeyBUYWJsZSB9IGZyb20gJ3JlYWN0c3RyYXAnOwoKdmFyIHZhbGlkYXRpb25TY2hlbWEgPSBmdW5jdGlvbiB2YWxpZGF0aW9uU2NoZW1hKCkgewogIHJldHVybiBZdXAub2JqZWN0KCkuc2hhcGUoewogICAgbmFtZTogWXVwLnN0cmluZygpLm1pbig1LCAiVFx4RUFuIG5oXHhGM20gcXV5XHUxRUMxbiBwaFx1MUVBM2kgbFx1MUVEQm4gaFx1MDFBMW4gNSBrXHhFRCB0XHUxRUYxIikucmVxdWlyZWQoJ1TDqm4gbmjDs20gcXV54buBbiBraMO0bmcgxJHhu4MgdHLhu5FuZycpCiAgfSk7Cn07CgppbXBvcnQgeyB2YWxpZGF0ZSB9IGZyb20gJy4uLy4uLy4uLy4uL3NoYXJlZC91dGlscy9ub3JtYWxpemUnOwpleHBvcnQgdmFyIG1hcHBpbmdTdGF0dXMgPSB7CiAgQUNUSVZFOiAnxJBBTkcgSE/huqBUIMSQ4buYTkcnLAogIERJU0FCTEVEOiAnS0jDlE5HIEhP4bqgVCDEkOG7mE5HJywKICBERUxFVEVEOiAnxJDDgyBYw5NBJwp9OwoKdmFyIEVkaXRQZXJtaXNzaW9uR3JvdXBzID0gZnVuY3Rpb24gRWRpdFBlcm1pc3Npb25Hcm91cHMocHJvcHMpIHsKICB2YXIgX3VzZVNlbGVjdG9yID0gdXNlU2VsZWN0b3IoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUucGVybWlzc2lvbjsKICB9KSwKICAgICAgaW5pdGlhbFN0YXRlID0gX3VzZVNlbGVjdG9yLmluaXRpYWxTdGF0ZTsKCiAgdmFyIGNoZWNrYm94UmVmID0gdXNlUmVmKCk7CiAgdmFyIGRpc3BhdGNoID0gdXNlRGlzcGF0Y2goKTsKICB2YXIgaGlzdG9yeSA9IHVzZUhpc3RvcnkoKTsKCiAgdmFyIF91c2VTdGF0ZSA9IHVzZVN0YXRlKHt9KSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIGNoZWNrYm94ID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0Q2hlY2tib3ggPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZVN0YXRlMyA9IHVzZVN0YXRlKFtdKSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBzZWxlY3RlZFBlcm1pc3Npb24gPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRTZWxlY3RlZFBlcm1pc3Npb24gPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgc2VsZWN0QnlJZCA9IGdsb2JhbGl6ZWRQZXJtaXNzaW9uR3JvdXBzU2VsZWN0b3JzLnNlbGVjdEJ5SWQ7CiAgdmFyIHBlckdyb3VwID0gdXNlU2VsZWN0b3IoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICByZXR1cm4gc2VsZWN0QnlJZChzdGF0ZSwgcHJvcHMubWF0Y2gucGFyYW1zLmlkKTsKICB9KTsKCiAgdmFyIF91c2VTdGF0ZTUgPSB1c2VTdGF0ZShudWxsKSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDIpLAogICAgICBpbml0VmFsdWVzID0gX3VzZVN0YXRlNlswXSwKICAgICAgc2V0SW5pdFZhbHVlcyA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBpbml0aWFsVmFsdWVzID0gewogICAgbmFtZTogJycsCiAgICBub3RlOiAnJwogIH07CiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHsKICAgIGRpc3BhdGNoKGdldERldGFpbFBlcm1pc3Npb25Hcm91cHMoewogICAgICBpZDogcHJvcHMubWF0Y2gucGFyYW1zLmlkLAogICAgICBkZXBlbmRlbmN5OiB0cnVlCiAgICB9KSk7CiAgICBkaXNwYXRjaChnZXRQZXJtaXNzaW9uVHlwZSh7CiAgICAgIHBhZ2U6IDAsCiAgICAgIHNpemU6IDIwLAogICAgICBzb3J0OiAnY3JlYXRlZERhdGUsZGVzYycsCiAgICAgIGRlcGVuZGVuY3k6IHRydWUKICAgIH0pKTsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGRpc3BhdGNoKHJlc2V0KCkpOwogICAgfTsKICB9LCBbXSk7CiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHsKICAgIHNldEluaXRWYWx1ZXMocGVyR3JvdXApOwoKICAgIGlmIChwZXJHcm91cCAmJiBwZXJHcm91cC5wZXJtaXNzaW9uR3JvdXBBc3NvY2lhdGVzKSB7CiAgICAgIHZhciBncm91cCA9IHBlckdyb3VwLnBlcm1pc3Npb25Hcm91cEFzc29jaWF0ZXMucmVkdWNlKGZ1bmN0aW9uIChyLCBhKSB7CiAgICAgICAgclthLnR5cGVdID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShyW2EudHlwZV0gfHwgW10pLCBbYV0pOwogICAgICAgIHJldHVybiByOwogICAgICB9LCB7fSk7CiAgICAgIHZhciBkYXRhID0gT2JqZWN0LmtleXMoZ3JvdXApLm1hcChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHR5cGU6IGtleSwKICAgICAgICAgIHR5cGVOYW1lOiBncm91cFtrZXldWzBdLnR5cGVOYW1lLAogICAgICAgICAgcGVybWlzc2lvbnM6IGdyb3VwW2tleV0KICAgICAgICB9OwogICAgICB9KTsKICAgICAgc2V0U2VsZWN0ZWRQZXJtaXNzaW9uKF90b0NvbnN1bWFibGVBcnJheShkYXRhKSk7CiAgICB9CiAgfSwgW3Blckdyb3VwXSk7CgogIHZhciBvbkdldFBlcm1pc3Npb24gPSBmdW5jdGlvbiBvbkdldFBlcm1pc3Npb24odmFsdWUpIHsKICAgIHZhciBwYXJhbXMgPSB7CiAgICAgIHR5cGU6IHZhbHVlCiAgICB9OwogICAgZGlzcGF0Y2goZ2V0UGVybWlzc2lvbnMocGFyYW1zKSk7CiAgfTsKCiAgdmFyIG9uU3VibWl0ID0gZnVuY3Rpb24gb25TdWJtaXQodmFsdWVzLCBfcmVmKSB7CiAgICB2YXIgcmVzZXRGb3JtID0gX3JlZi5yZXNldEZvcm07CiAgICB2YXIgYXJyUGVybWlzc2lvbiA9IFtdOwogICAgdmFsdWVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh2YWx1ZXMpKTsKICAgIHNlbGVjdGVkUGVybWlzc2lvbi5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3RQZXIpIHsKICAgICAgaWYgKHNlbGVjdFBlci5wZXJtaXNzaW9ucykgewogICAgICAgIGFyclBlcm1pc3Npb24gPSBhcnJQZXJtaXNzaW9uLmNvbmNhdChzZWxlY3RQZXIucGVybWlzc2lvbnMpOwogICAgICB9CiAgICB9KTsKICAgIGlmIChhcnJQZXJtaXNzaW9uLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwoKICAgIGlmIChzZWxlY3RlZFBlcm1pc3Npb24ubWFwKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7CiAgICAgIHJldHVybiBwZXJtaXNzaW9uLnBlcm1pc3Npb25zOwogICAgfSkucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyZW50KSB7CiAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHByZXYpLCBfdG9Db25zdW1hYmxlQXJyYXkoY3VycmVudCkpOwogICAgfSwgW10pLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFsdWVzLnBlcm1pc3Npb25zID0gYXJyUGVybWlzc2lvbjsKICAgIGRpc3BhdGNoKGZldGNoaW5nKCkpOwogICAgZGlzcGF0Y2godXBkYXRlUGVybWlzc2lvbkdyb3Vwcyh2YWx1ZXMpKTsKICAgIHJlc2V0Rm9ybSgpOwogIH07CgogIHZhciBvbkNoZWNrID0gZnVuY3Rpb24gb25DaGVjayhzZXRDaGVja2JveEZ1bmMsIGNoZWNrYm94VmFsdWUpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoZSkgewogICAgICBlLnBlcnNpc3QoKTsKICAgICAgc2V0Q2hlY2tib3hGdW5jKGZ1bmN0aW9uIChwcmV2U3RhdGUpIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBwcmV2U3RhdGUpLCB7fSwgX2RlZmluZVByb3BlcnR5KHt9LCBlLnRhcmdldC52YWx1ZSwgIWNoZWNrYm94VmFsdWVbZS50YXJnZXQudmFsdWVdKSk7CiAgICAgIH0pOwogICAgfTsKICB9OwoKICB2YXIgb25TZWxlY3RBbGwgPSBmdW5jdGlvbiBvblNlbGVjdEFsbChjaGVja2VkVmFsdWUpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBjb3B5Q2hlY2tib3ggPSBfb2JqZWN0U3ByZWFkKHt9LCBjaGVja2JveCk7CgogICAgICBPYmplY3Qua2V5cyhjb3B5Q2hlY2tib3gpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIGNvcHlDaGVja2JveFtrZXldID0gY2hlY2tlZFZhbHVlOwogICAgICB9KTsKICAgICAgc2V0Q2hlY2tib3goY29weUNoZWNrYm94KTsKCiAgICAgIGlmIChjaGVja2JveFJlZi5jdXJyZW50KSB7CiAgICAgICAgY2hlY2tib3hSZWYuY3VycmVudC5jaGVja2VkID0gY2hlY2tlZFZhbHVlOwogICAgICB9CiAgICB9OwogIH07CgogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBpZiAoY2hlY2tib3ggJiYgaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zICYmIEFycmF5LmlzQXJyYXkoaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zKSAmJiBpbml0aWFsU3RhdGUucGVybWlzc2lvbnMubGVuZ3RoID4gMCkgewogICAgICB2YXIgc2VsZWN0ZWRBcnIgPSBbXTsKICAgICAgT2JqZWN0LmtleXMoY2hlY2tib3gpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIGlmIChjaGVja2JveFtrZXldKSB7CiAgICAgICAgICBzZWxlY3RlZEFyci5wdXNoKGtleSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgaGFuZGxlU2VsZWN0UGVybWlzc2lvbihudWxsLCBzZWxlY3RlZEFycik7CiAgICB9CiAgfSwgW2NoZWNrYm94XSk7CgogIHZhciByZW1vdmVQZXJtaXNzaW9uID0gZnVuY3Rpb24gcmVtb3ZlUGVybWlzc2lvbihpbmRleCkgewogICAgdmFyIGFyciA9IF90b0NvbnN1bWFibGVBcnJheShzZWxlY3RlZFBlcm1pc3Npb24pOwoKICAgIGFyci5zcGxpY2UoaW5kZXgsIDEpOwogICAgc2V0U2VsZWN0ZWRQZXJtaXNzaW9uKGFycik7CiAgfTsKCiAgdmFyIGhhbmRsZVNlbGVjdFBlcm1pc3Npb24gPSBmdW5jdGlvbiBoYW5kbGVTZWxlY3RQZXJtaXNzaW9uKGUsIHZhbHVlcykgewogICAgLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqLwogICAgdmFyIHR5cGUgPSBpbml0aWFsU3RhdGUucGVybWlzc2lvbnNbMF0udHlwZTsKICAgIHZhciB0eXBlTmFtZSA9IGluaXRpYWxTdGF0ZS5wZXJtaXNzaW9uc1swXS50eXBlTmFtZTsKICAgIHZhciBmb3VuZGVkSW5kZXggPSBzZWxlY3RlZFBlcm1pc3Npb24uZmluZEluZGV4KGZ1bmN0aW9uIChwZXIpIHsKICAgICAgcmV0dXJuIHBlci50eXBlID09PSB0eXBlOwogICAgfSk7CgogICAgaWYgKHZhbHVlcyAmJiBBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHsKICAgICAgaWYgKGZvdW5kZWRJbmRleCA+IC0xKSB7CiAgICAgICAgc2VsZWN0ZWRQZXJtaXNzaW9uW2ZvdW5kZWRJbmRleF0ucGVybWlzc2lvbnMgPSBpbml0aWFsU3RhdGUucGVybWlzc2lvbnMuZmlsdGVyKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7CiAgICAgICAgICByZXR1cm4gdmFsdWVzLmluY2x1ZGVzKHBlcm1pc3Npb24uaWQudG9TdHJpbmcoKSk7CiAgICAgICAgfSk7CiAgICAgICAgc2V0U2VsZWN0ZWRQZXJtaXNzaW9uKF90b0NvbnN1bWFibGVBcnJheShzZWxlY3RlZFBlcm1pc3Npb24pKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgc2VsZWN0ZWRQZXJtaXNzaW9uT2JqID0gewogICAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICAgIHR5cGVOYW1lOiB0eXBlTmFtZSwKICAgICAgICAgIHBlcm1pc3Npb25zOiBpbml0aWFsU3RhdGUucGVybWlzc2lvbnMuZmlsdGVyKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZXMuaW5jbHVkZXMocGVybWlzc2lvbi5pZC50b1N0cmluZygpKTsKICAgICAgICAgIH0pCiAgICAgICAgfTsKICAgICAgICBzZXRTZWxlY3RlZFBlcm1pc3Npb24oW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShzZWxlY3RlZFBlcm1pc3Npb24pLCBbc2VsZWN0ZWRQZXJtaXNzaW9uT2JqXSkpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHZhbHVlcyAmJiBBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA9PSAwKSB7CiAgICAgIGlmIChmb3VuZGVkSW5kZXggPiAtMSkgewogICAgICAgIHZhciBhcnIgPSBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0ZWRQZXJtaXNzaW9uKTsKCiAgICAgICAgYXJyLnNwbGljZShmb3VuZGVkSW5kZXgsIDEpOwogICAgICAgIHNldFNlbGVjdGVkUGVybWlzc2lvbihhcnIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB2YXIgX2FycjIgPSBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0ZWRQZXJtaXNzaW9uKTsKCiAgICAgIHZhciBmaW5kRW1wdHkgPSBfYXJyMi5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5wZXJtaXNzaW9ucy5sZW5ndGggPT09IDA7CiAgICAgIH0pOwoKICAgICAgaWYgKGZpbmRFbXB0eSA+IC0xKSBfYXJyMi5zcGxpY2UoZmluZEVtcHR5LCAxKTsKICAgICAgc2V0U2VsZWN0ZWRQZXJtaXNzaW9uKF9hcnIyKTsKICAgIH0KICB9OwoKICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkgewogICAgaWYgKGluaXRpYWxTdGF0ZS5wZXJtaXNzaW9ucyAmJiBBcnJheS5pc0FycmF5KGluaXRpYWxTdGF0ZS5wZXJtaXNzaW9ucykpIHsKICAgICAgdmFyIHRlbXBQZXIgPSB7fTsKICAgICAgaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKHBlcikgewogICAgICAgIHRlbXBQZXJbcGVyLmlkXSA9IGZhbHNlOwogICAgICB9KTsKICAgICAgc2V0Q2hlY2tib3godGVtcFBlcik7CiAgICB9CiAgfSwgW2luaXRpYWxTdGF0ZS5wZXJtaXNzaW9uc10pOwogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBpZiAoaW5pdGlhbFN0YXRlLnVwZGF0aW5nU3VjY2VzcykgewogICAgICBkaXNwYXRjaChyZXNldCgpKTsKICAgICAgaGlzdG9yeS5nb0JhY2soKTsKICAgIH0KICB9LCBbaW5pdGlhbFN0YXRlLnVwZGF0aW5nU3VjY2Vzc10pOwogIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQ2FyZCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NhcmRIZWFkZXIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDYXJkVGl0bGUsIHsKICAgIGNsYXNzTmFtZTogImNhcmQtdGl0bGUgbWItMCIKICB9LCAiQ2hcdTFFQzluaCBzXHUxRUVEYSBuaFx4RjNtIHF1eVx1MUVDMW4iKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDYXJkQm9keSwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWlrLCB7CiAgICBpbml0aWFsVmFsdWVzOiBpbml0VmFsdWVzIHx8IGluaXRpYWxWYWx1ZXMsCiAgICBlbmFibGVSZWluaXRpYWxpemU6IHRydWUsCiAgICB2YWxpZGF0ZTogdmFsaWRhdGUodmFsaWRhdGlvblNjaGVtYSksCiAgICBvblN1Ym1pdDogb25TdWJtaXQKICB9LCBmdW5jdGlvbiAoX3JlZjIpIHsKICAgIHZhciB2YWx1ZXMgPSBfcmVmMi52YWx1ZXMsCiAgICAgICAgZXJyb3JzID0gX3JlZjIuZXJyb3JzLAogICAgICAgIGhhbmRsZUNoYW5nZSA9IF9yZWYyLmhhbmRsZUNoYW5nZSwKICAgICAgICBoYW5kbGVCbHVyID0gX3JlZjIuaGFuZGxlQmx1ciwKICAgICAgICBoYW5kbGVTdWJtaXQgPSBfcmVmMi5oYW5kbGVTdWJtaXQsCiAgICAgICAgaGFuZGxlUmVzZXQgPSBfcmVmMi5oYW5kbGVSZXNldDsKICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDRm9ybSwgewogICAgICBvblN1Ym1pdDogaGFuZGxlU3VibWl0LAogICAgICBub1ZhbGlkYXRlOiB0cnVlLAogICAgICBuYW1lOiAic2ltcGxlRm9ybSIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgbGc6ICIxMiIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENGb3JtR3JvdXAsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENMYWJlbCwgewogICAgICBodG1sRm9yOiAibG9naW4iCiAgICB9LCAiVFx4RUFuIG5oXHhGM20gcXV5XHUxRUMxbiIpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSW5wdXQsIHsKICAgICAgdHlwZTogInRleHQiLAogICAgICBuYW1lOiAibmFtZSIsCiAgICAgIGlkOiAibmFtZSIsCiAgICAgIHBsYWNlaG9sZGVyOiAiVFx4RUFuIG5oXHhGM20gcXV5XHUxRUMxbiIsCiAgICAgIG9uQ2hhbmdlOiBoYW5kbGVDaGFuZ2UsCiAgICAgIG9uQmx1cjogaGFuZGxlQmx1ciwKICAgICAgdmFsdWU6IHZhbHVlcy5uYW1lCiAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0ludmFsaWRGZWVkYmFjaywgewogICAgICBjbGFzc05hbWU6ICJkLWJsb2NrIgogICAgfSwgZXJyb3JzLm5hbWUpKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgbGc6ICIxMiIsCiAgICAgIHN0eWxlOiB7CiAgICAgICAgekluZGV4OiAxMDAKICAgICAgfQogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0Zvcm1Hcm91cCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0xhYmVsLCB7CiAgICAgIGh0bWxGb3I6ICJ1c2VyTmFtZSIKICAgIH0sICJDaFx1MUVDRG4gbmhceEYzbSBjaFx1MUVFOWMgblx1MDEwM25nIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFNlbGVjdCwgewogICAgICBuYW1lOiAiZGVwYXJ0bWVudCIsCiAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgICAgb25HZXRQZXJtaXNzaW9uKGUudmFsdWUpOwogICAgICB9LAogICAgICBwbGFjZWhvbGRlcjogIkNoXHUxRUNEbiBuaFx4RjNtIGNoXHUxRUU5YyBuXHUwMTAzbmciLAogICAgICBvcHRpb25zOiBpbml0aWFsU3RhdGUucGVybWlzc2lvblR5cGVzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB2YWx1ZTogaXRlbS5uYW1lLAogICAgICAgICAgbGFiZWw6IGl0ZW0uZGVzY3JpcHRpb24KICAgICAgICB9OwogICAgICB9KQogICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBsZzogIjEyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0Zvcm1Hcm91cCwgewogICAgICBjb2x1bW46IHRydWUKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENSb3csIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgY2xhc3NOYW1lOiAibWItMiIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENMYWJlbCwgbnVsbCwgIkNoXHUxRUU5YyBuXHUwMTAzbmciKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgY2xhc3NOYW1lOiAibWItMiIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENCdXR0b25Hcm91cCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICBjb2xvcjogInNlY29uZGFyeSIsCiAgICAgIG9uQ2xpY2s6IG9uU2VsZWN0QWxsKHRydWUpCiAgICB9LCAiQ2hcdTFFQ0RuIHRcdTFFQTV0IGNcdTFFQTMiKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICBjb2xvcjogInNlY29uZGFyeSIsCiAgICAgIG9uQ2xpY2s6IG9uU2VsZWN0QWxsKGZhbHNlKQogICAgfSwgIkJcdTFFQ0YgY2hcdTFFQ0RuIHRcdTFFQTV0IGNcdTFFQTMiKSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBtZDogIjkiCiAgICB9LCBpbml0aWFsU3RhdGUucGVybWlzc2lvbnMgJiYgaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zLm1hcChmdW5jdGlvbiAoZW50aXR5KSB7CiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDRm9ybUdyb3VwLCB7CiAgICAgICAgdmFyaWFudDogImNoZWNrYm94IiwKICAgICAgICBjbGFzc05hbWU6ICJtYi0yIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSW5wdXRDaGVja2JveCwgewogICAgICAgIGNsYXNzTmFtZTogImZvcm0tY2hlY2staW5wdXQiLAogICAgICAgIGlkOiBlbnRpdHkuaWQsCiAgICAgICAgY2hlY2tlZDogY2hlY2tib3hbZW50aXR5LmlkXSwKICAgICAgICBvbkNoYW5nZTogb25DaGVjayhzZXRDaGVja2JveCwgY2hlY2tib3gpLAogICAgICAgIG5hbWU6IGVudGl0eS5pZCwKICAgICAgICB2YWx1ZTogZW50aXR5LmlkCiAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDTGFiZWwsIHsKICAgICAgICB2YXJpYW50OiAiY2hlY2tib3giLAogICAgICAgIGh0bWxGb3I6ICJyYWRpbzEiCiAgICAgIH0sIGVudGl0eS5kZXNjcmlwdGlvbikpOwogICAgfSkpKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRhYmxlLCB7CiAgICAgIHJlc3BvbnNpdmU6IHRydWUKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0aGVhZCIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0ciIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0aCIsIHsKICAgICAgY2xhc3NOYW1lOiAiaGFuZCB0ZXh0LXJpZ2h0IGluZGV4LWNvbHVtbiIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIlNUVCIpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRoIiwgewogICAgICBjbGFzc05hbWU6ICJoYW5kIHRleHQtbGVmdCIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIk5oXHhGM20gY2hcdTFFRTljIG5cdTAxMDNuZyIpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRoIiwgewogICAgICBjbGFzc05hbWU6ICJoYW5kIHRleHQtbGVmdCIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIkRhbmggc1x4RTFjaCBjaFx1MUVFOWMgblx1MDEwM25nIikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidGgiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsICJUaGFvIHRceEUxYyIpKSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidGJvZHkiLCBudWxsLCBzZWxlY3RlZFBlcm1pc3Npb24ubWFwKGZ1bmN0aW9uIChwZXJtaXNzaW9uLCBpKSB7CiAgICAgIGlmIChwZXJtaXNzaW9uLnBlcm1pc3Npb25zICYmIHBlcm1pc3Npb24ucGVybWlzc2lvbnMubGVuZ3RoID4gMCkgewogICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidHIiLCB7CiAgICAgICAgICBrZXk6IHBlcm1pc3Npb24udHlwZQogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0ZCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogInRleHQtY2VudGVyIgogICAgICAgIH0sIGkgKyAxKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRkIiwgbnVsbCwgcGVybWlzc2lvbi50eXBlTmFtZSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0ZCIsIG51bGwsIHBlcm1pc3Npb24ucGVybWlzc2lvbnMgPyBwZXJtaXNzaW9uLnBlcm1pc3Npb25zLm1hcChmdW5jdGlvbiAocGVyKSB7CiAgICAgICAgICByZXR1cm4gcGVyLmRlc2NyaXB0aW9uOwogICAgICAgIH0pLmpvaW4oJyAtLSAnKSA6ICcnKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRkIiwgewogICAgICAgICAgY2xhc3NOYW1lOiAidGV4dC1jZW50ZXIiCiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICAgICAgdHlwZTogInJlc2V0IiwKICAgICAgICAgIHNpemU6ICJsZyIsCiAgICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICByZXR1cm4gcmVtb3ZlUGVybWlzc2lvbihpKTsKICAgICAgICAgIH0sCiAgICAgICAgICBjbGFzc05hbWU6ICJtbC01IgogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENJY29uLCB7CiAgICAgICAgICBuYW1lOiAiY2lsLWJhbiIKICAgICAgICB9KSkpKTsKICAgICAgfQogICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBsZzogIjEyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0Zvcm1Hcm91cCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0xhYmVsLCB7CiAgICAgIGh0bWxGb3I6ICJsb2dpbiIKICAgIH0sICJHaGkgY2hceEZBIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENUZXh0YXJlYSwgewogICAgICB0eXBlOiAidGV4dGFyZWEiLAogICAgICBuYW1lOiAibm90ZSIsCiAgICAgIGlkOiAibm90ZSIsCiAgICAgIHBsYWNlaG9sZGVyOiAiR2hpIGNoXHhGQSIsCiAgICAgIG9uQ2hhbmdlOiBoYW5kbGVDaGFuZ2UsCiAgICAgIG9uQmx1cjogaGFuZGxlQmx1ciwKICAgICAgdmFsdWU6IHZhbHVlcy5ub3RlCiAgICB9KSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDRm9ybUdyb3VwLCB7CiAgICAgIGNsYXNzTmFtZTogImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICB0eXBlOiAic3VibWl0IiwKICAgICAgc2l6ZTogImxnIiwKICAgICAgY29sb3I6ICJwcmltYXJ5IiwKICAgICAgZGlzYWJsZWQ6IGluaXRpYWxTdGF0ZS5sb2FkaW5nCiAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSWNvbiwgewogICAgICBuYW1lOiAiY2lsLXNhdmUiCiAgICB9KSwgIiAiLCBpbml0aWFsU3RhdGUubG9hZGluZyA/ICfEkGFuZyB44butIGzDvScgOiAnTMawdScpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQnV0dG9uLCB7CiAgICAgIHR5cGU6ICJyZXNldCIsCiAgICAgIHNpemU6ICJsZyIsCiAgICAgIGNvbG9yOiAiZGFuZ2VyIiwKICAgICAgb25DbGljazogaGFuZGxlUmVzZXQsCiAgICAgIGNsYXNzTmFtZTogIm1sLTUiCiAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSWNvbiwgewogICAgICBuYW1lOiAiY2lsLWJhbiIKICAgIH0pLCAiIFhceEYzYSBuaFx1MUVBRHAgbGlcdTFFQzd1IikpKTsKICB9KSkpOwp9OwoKZXhwb3J0IGRlZmF1bHQgRWRpdFBlcm1pc3Npb25Hcm91cHM7"},{"version":3,"sources":["/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/user/UserPermission/edit-permission.js"],"names":["React","useEffect","useRef","useState","CButton","CCard","CCardHeader","CCardBody","CCol","CForm","CInvalidFeedback","CFormGroup","CLabel","CInput","CRow","CCardTitle","CInputCheckbox","CButtonGroup","CTextarea","CIcon","Formik","Yup","useDispatch","useSelector","getDetailPermissionGroups","getPermissions","getPermissionType","updatePermissionGroups","useHistory","fetching","globalizedPermissionGroupsSelectors","reset","Select","Table","validationSchema","object","shape","name","string","min","required","validate","mappingStatus","ACTIVE","DISABLED","DELETED","EditPermissionGroups","props","state","permission","initialState","checkboxRef","dispatch","history","checkbox","setCheckbox","selectedPermission","setSelectedPermission","selectById","perGroup","match","params","id","initValues","setInitValues","initialValues","note","dependency","page","size","sort","permissionGroupAssociates","group","reduce","r","a","type","data","Object","keys","map","key","typeName","permissions","onGetPermission","value","onSubmit","values","resetForm","arrPermission","JSON","parse","stringify","forEach","selectPer","concat","length","prev","current","onCheck","setCheckboxFunc","checkboxValue","e","persist","prevState","target","onSelectAll","checkedValue","copyCheckbox","checked","Array","isArray","selectedArr","push","handleSelectPermission","removePermission","index","arr","splice","foundedIndex","findIndex","per","filter","includes","toString","selectedPermissionObj","findEmpty","item","tempPer","updatingSuccess","goBack","errors","handleChange","handleBlur","handleSubmit","handleReset","zIndex","permissionTypes","label","description","entity","i","join","loading"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport {\n  CButton,\n  CCard,\n  CCardHeader,\n  CCardBody,\n  CCol,\n  CForm,\n  CInvalidFeedback,\n  CFormGroup,\n  CLabel,\n  CInput,\n  CRow,\n  CCardTitle,\n  CInputCheckbox,\n  CButtonGroup,\n  CTextarea\n} from '@coreui/react/lib';\nimport CIcon from '@coreui/icons-react/lib/CIcon';;\nimport { Formik } from 'formik';\nimport * as Yup from 'yup';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getDetailPermissionGroups, getPermissions, getPermissionType, updatePermissionGroups } from './permission.api';\n\nimport { useHistory } from 'react-router-dom';\nimport { fetching, globalizedPermissionGroupsSelectors, reset } from './permission.reducer';\nimport Select from 'react-select';\nimport { Table } from 'reactstrap';\n\nconst validationSchema = function() {\n  return Yup.object().shape({\n    name: Yup.string()\n      .min(5, `Tên nhóm quyền phải lớn hơn 5 kí tự`)\n      .required('Tên nhóm quyền không để trống')\n  });\n};\n\nimport { validate } from '../../../../shared/utils/normalize';\n\nexport const mappingStatus = {\n  ACTIVE: 'ĐANG HOẠT ĐỘNG',\n  DISABLED: 'KHÔNG HOẠT ĐỘNG',\n  DELETED: 'ĐÃ XÓA'\n};\n\nconst EditPermissionGroups = props => {\n  const { initialState } = useSelector(state => state.permission);\n  const checkboxRef = useRef();\n\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const [checkbox, setCheckbox] = useState({});\n  const [selectedPermission, setSelectedPermission] = useState([]);\n  const { selectById } = globalizedPermissionGroupsSelectors;\n  const perGroup = useSelector(state => selectById(state, props.match.params.id));\n\n  const [initValues, setInitValues] = useState(null);\n\n  const initialValues = {\n    name: '',\n    note: ''\n  };\n\n  useEffect(() => {\n    dispatch(getDetailPermissionGroups({ id: props.match.params.id, dependency: true }));\n    dispatch(getPermissionType({ page: 0, size: 20, sort: 'createdDate,desc', dependency: true }));\n    return () => {\n      dispatch(reset());\n    };\n  }, []);\n\n  useEffect(() => {\n    setInitValues(perGroup);\n    if (perGroup && perGroup.permissionGroupAssociates) {\n      const group = perGroup.permissionGroupAssociates.reduce((r, a) => {\n        r[a.type] = [...(r[a.type] || []), a];\n        return r;\n      }, {});\n      const data = Object.keys(group).map(key => ({\n        type: key,\n        typeName: group[key][0].typeName,\n        permissions: group[key]\n      }));\n      setSelectedPermission([...data]);\n    }\n  }, [perGroup]);\n\n  const onGetPermission = value => {\n    const params = { type: value };\n    dispatch(getPermissions(params));\n  };\n\n  const onSubmit = (values, { resetForm }) => {\n    let arrPermission = [];\n    values = JSON.parse(JSON.stringify(values));\n    selectedPermission.forEach(selectPer => {\n      if (selectPer.permissions) {\n        arrPermission = arrPermission.concat(selectPer.permissions);\n      }\n    });\n    if (arrPermission.length === 0) return;\n    if (selectedPermission.map(permission => permission.permissions).reduce((prev, current) => [...prev, ...current], []).length === 0) {\n      return;\n    }\n    values.permissions = arrPermission;\n\n    dispatch(fetching());\n    dispatch(updatePermissionGroups(values));\n    resetForm();\n  };\n\n  const onCheck = (setCheckboxFunc, checkboxValue) => {\n    return e => {\n      e.persist();\n      setCheckboxFunc(prevState => ({ ...prevState, [e.target.value]: !checkboxValue[e.target.value] }));\n    };\n  };\n\n  const onSelectAll = checkedValue => () => {\n    const copyCheckbox = { ...checkbox };\n    Object.keys(copyCheckbox).forEach(key => {\n      copyCheckbox[key] = checkedValue;\n    });\n    setCheckbox(copyCheckbox);\n    if (checkboxRef.current) {\n      checkboxRef.current.checked = checkedValue;\n    }\n  };\n\n  useEffect(() => {\n    if (checkbox && initialState.permissions && Array.isArray(initialState.permissions) && initialState.permissions.length > 0) {\n      const selectedArr = [];\n      Object.keys(checkbox).forEach(key => {\n        if (checkbox[key]) {\n          selectedArr.push(key);\n        }\n      });\n      handleSelectPermission(null, selectedArr);\n    }\n  }, [checkbox]);\n\n  const removePermission = index => {\n    const arr = [...selectedPermission];\n    arr.splice(index, 1);\n    setSelectedPermission(arr);\n  };\n\n  const handleSelectPermission = (e, values) => {\n    /* eslint-disable no-console */\n    const type = initialState.permissions[0].type;\n    const typeName = initialState.permissions[0].typeName;\n    const foundedIndex = selectedPermission.findIndex(per => per.type === type);\n    if (values && Array.isArray(values) && values.length > 0) {\n      if (foundedIndex > -1) {\n        selectedPermission[foundedIndex].permissions = initialState.permissions.filter(permission =>\n          values.includes(permission.id.toString())\n        );\n        setSelectedPermission([...selectedPermission]);\n      } else {\n        const selectedPermissionObj = {\n          type,\n          typeName,\n          permissions: initialState.permissions.filter(permission => values.includes(permission.id.toString()))\n        };\n\n        setSelectedPermission([...selectedPermission, selectedPermissionObj]);\n      }\n    } else if (values && Array.isArray(values) && values.length == 0) {\n      if (foundedIndex > -1) {\n        const arr = [...selectedPermission];\n        arr.splice(foundedIndex, 1);\n        setSelectedPermission(arr);\n      }\n    } else {\n      const arr = [...selectedPermission];\n      const findEmpty = arr.findIndex(item => item.permissions.length === 0);\n      if (findEmpty > -1) arr.splice(findEmpty, 1);\n      setSelectedPermission(arr);\n    }\n  };\n\n  useEffect(() => {\n    if (initialState.permissions && Array.isArray(initialState.permissions)) {\n      const tempPer = {};\n      initialState.permissions.forEach(per => {\n        tempPer[per.id] = false;\n      });\n      setCheckbox(tempPer);\n    }\n  }, [initialState.permissions]);\n\n  useEffect(() => {\n    if (initialState.updatingSuccess) {\n      dispatch(reset());\n      history.goBack();\n    }\n  }, [initialState.updatingSuccess]);\n\n  return (\n    <CCard>\n      <CCardHeader>\n        <CCardTitle className=\"card-title mb-0\">Chỉnh sửa nhóm quyền</CCardTitle>\n      </CCardHeader>\n      <CCardBody>\n        <Formik initialValues={initValues || initialValues} enableReinitialize validate={validate(validationSchema)} onSubmit={onSubmit}>\n          {({\n            values,\n            errors,\n\n            handleChange,\n            handleBlur,\n            handleSubmit,\n\n            handleReset\n          }) => (\n            <CForm onSubmit={handleSubmit} noValidate name=\"simpleForm\">\n              <CCol lg=\"12\">\n                <CFormGroup>\n                  <CLabel htmlFor=\"login\">Tên nhóm quyền</CLabel>\n                  <CInput\n                    type=\"text\"\n                    name=\"name\"\n                    id=\"name\"\n                    placeholder=\"Tên nhóm quyền\"\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    value={values.name}\n                  />\n                  <CInvalidFeedback className=\"d-block\">{errors.name}</CInvalidFeedback>\n                </CFormGroup>\n              </CCol>\n              <CCol lg=\"12\" style={{ zIndex: 100 }}>\n                <CFormGroup>\n                  <CLabel htmlFor=\"userName\">Chọn nhóm chức năng</CLabel>\n                  <Select\n                    name=\"department\"\n                    onChange={e => {\n                      onGetPermission(e.value);\n                    }}\n                    placeholder=\"Chọn nhóm chức năng\"\n                    options={initialState.permissionTypes.map(item => ({\n                      value: item.name,\n                      label: item.description\n                    }))}\n                  />\n                </CFormGroup>\n              </CCol>\n              <CCol lg=\"12\">\n                <CFormGroup column>\n                  <CRow>\n                    <CCol className=\"mb-2\">\n                      <CLabel>Chức năng</CLabel>\n                    </CCol>\n                    <CCol className=\"mb-2\">\n                      <CButtonGroup>\n                        <CButton color=\"secondary\" onClick={onSelectAll(true)}>\n                          Chọn tất cả\n                        </CButton>\n                        <CButton color=\"secondary\" onClick={onSelectAll(false)}>\n                          Bỏ chọn tất cả\n                        </CButton>\n                      </CButtonGroup>\n                    </CCol>\n                  </CRow>\n                  <CCol md=\"9\">\n                    {initialState.permissions &&\n                      initialState.permissions.map(entity => {\n                        return (\n                          <CFormGroup variant=\"checkbox\" className=\"mb-2\">\n                            <CInputCheckbox\n                              className=\"form-check-input\"\n                              id={entity.id}\n                              checked={checkbox[entity.id]}\n                              onChange={onCheck(setCheckbox, checkbox)}\n                              name={entity.id}\n                              value={entity.id}\n                            />\n                            <CLabel variant=\"checkbox\" htmlFor=\"radio1\">\n                              {entity.description}\n                            </CLabel>\n                          </CFormGroup>\n                        );\n                      })}\n                  </CCol>\n                </CFormGroup>\n              </CCol>\n              <Table responsive>\n                <thead>\n                  <tr>\n                    <th className=\"hand text-right index-column\">\n                      <span>STT</span>\n                    </th>\n                    <th className=\"hand text-left\">\n                      <span>Nhóm chức năng</span>\n                    </th>\n                    <th className=\"hand text-left\">\n                      <span>Danh sách chức năng</span>\n                    </th>\n                    <th>\n                      <span>Thao tác</span>\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {selectedPermission.map((permission, i) => {\n                    if (permission.permissions && permission.permissions.length > 0) {\n                      return (\n                        <tr key={permission.type}>\n                          <td className=\"text-center\">{i + 1}</td>\n                          <td>{permission.typeName}</td>\n                          <td>{permission.permissions ? permission.permissions.map(per => per.description).join(' -- ') : ''}</td>\n                          <td className=\"text-center\">\n                            <CButton type=\"reset\" size=\"lg\" color=\"danger\" onClick={() => removePermission(i)} className=\"ml-5\">\n                              <CIcon name=\"cil-ban\" />\n                            </CButton>\n                          </td>\n                        </tr>\n                      );\n                    }\n                  })}\n                </tbody>\n              </Table>\n              <CCol lg=\"12\">\n                <CFormGroup>\n                  <CLabel htmlFor=\"login\">Ghi chú</CLabel>\n                  <CTextarea\n                    type=\"textarea\"\n                    name=\"note\"\n                    id=\"note\"\n                    placeholder=\"Ghi chú\"\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    value={values.note}\n                  />\n                </CFormGroup>\n              </CCol>\n              <CFormGroup className=\"d-flex justify-content-center\">\n                <CButton type=\"submit\" size=\"lg\" color=\"primary\" disabled={initialState.loading}>\n                  <CIcon name=\"cil-save\" /> {initialState.loading ? 'Đang xử lý' : 'Lưu'}\n                </CButton>\n                <CButton type=\"reset\" size=\"lg\" color=\"danger\" onClick={handleReset} className=\"ml-5\">\n                  <CIcon name=\"cil-ban\" /> Xóa nhập liệu\n                </CButton>\n              </CFormGroup>\n            </CForm>\n          )}\n        </Formik>\n      </CCardBody>\n    </CCard>\n  );\n};\n\nexport default EditPermissionGroups;\n"]}]}