{"remainingRequest":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/thread-loader/dist/cjs.js??ref--4-2!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/babel-loader/lib/index.js??ref--4-3!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/source-map-loader/index.js!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/eslint-loader/dist/cjs.js!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/user/UserPermission/edit-permission.js","dependencies":[{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/user/UserPermission/edit-permission.js","mtime":1619210640208},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/react-hot-loader/webpack.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/source-map-loader/index.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90ZW1wbGF0ZU9iamVjdDsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgJiYgU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSkgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CgpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQoKZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAidW5kZWZpbmVkIiB8fCAhKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkpIHJldHVybjsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbChzdHJpbmdzLCByYXcpIHsgaWYgKCFyYXcpIHsgcmF3ID0gc3RyaW5ncy5zbGljZSgwKTsgfSByZXR1cm4gT2JqZWN0LmZyZWV6ZShPYmplY3QuZGVmaW5lUHJvcGVydGllcyhzdHJpbmdzLCB7IHJhdzogeyB2YWx1ZTogT2JqZWN0LmZyZWV6ZShyYXcpIH0gfSkpOyB9CgppbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnOwppbXBvcnQgeyBDQnV0dG9uLCBDQ2FyZCwgQ0NhcmRIZWFkZXIsIENDYXJkQm9keSwgQ0NvbCwgQ0Zvcm0sIENJbnZhbGlkRmVlZGJhY2ssIENGb3JtR3JvdXAsIENMYWJlbCwgQ0lucHV0LCBDUm93LCBDQ2FyZFRpdGxlLCBDSW5wdXRDaGVja2JveCwgQ0J1dHRvbkdyb3VwLCBDVGV4dGFyZWEgfSBmcm9tICdAY29yZXVpL3JlYWN0JzsKaW1wb3J0IENJY29uIGZyb20gJ0Bjb3JldWkvaWNvbnMtcmVhY3QnOwppbXBvcnQgeyBGb3JtaWsgfSBmcm9tICdmb3JtaWsnOwppbXBvcnQgKiBhcyBZdXAgZnJvbSAneXVwJzsKaW1wb3J0IHsgdXNlRGlzcGF0Y2gsIHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnOwppbXBvcnQgeyBnZXREZXRhaWxQZXJtaXNzaW9uR3JvdXBzLCBnZXRQZXJtaXNzaW9ucywgZ2V0UGVybWlzc2lvblR5cGUsIHVwZGF0ZVBlcm1pc3Npb25Hcm91cHMgfSBmcm9tICcuL3Blcm1pc3Npb24uYXBpJzsKaW1wb3J0IHsgdXNlSGlzdG9yeSB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nOwppbXBvcnQgeyBmZXRjaGluZywgZ2xvYmFsaXplZFBlcm1pc3Npb25Hcm91cHNTZWxlY3RvcnMsIHJlc2V0IH0gZnJvbSAnLi9wZXJtaXNzaW9uLnJlZHVjZXInOwppbXBvcnQgU2VsZWN0IGZyb20gJ3JlYWN0LXNlbGVjdCc7CmltcG9ydCB7IFRhYmxlIH0gZnJvbSAncmVhY3RzdHJhcCc7Cgp2YXIgdmFsaWRhdGlvblNjaGVtYSA9IGZ1bmN0aW9uIHZhbGlkYXRpb25TY2hlbWEoKSB7CiAgcmV0dXJuIFl1cC5vYmplY3QoKS5zaGFwZSh7CiAgICBuYW1lOiBZdXAuc3RyaW5nKCkubWluKDUoX3RlbXBsYXRlT2JqZWN0IHx8IChfdGVtcGxhdGVPYmplY3QgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsKFsiVFx4RUFuIG5oXHhGM20gcXV5XHUxRUMxbiBwaFx1MUVBM2kgbFx1MUVEQm4gaFx1MDFBMW4gNSBrXHhFRCB0XHUxRUYxIl0pKSkpLnJlcXVpcmVkKCdUw6puIG5ow7NtIHF1eeG7gW4ga2jDtG5nIMSR4buDIHRy4buRbmcnKQogIH0pOwp9OwoKaW1wb3J0IHsgdmFsaWRhdGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zaGFyZWQvdXRpbHMvbm9ybWFsaXplJzsKZXhwb3J0IHZhciBtYXBwaW5nU3RhdHVzID0gewogIEFDVElWRTogJ8SQQU5HIEhP4bqgVCDEkOG7mE5HJywKICBJTkFDVElWRTogJ0tIw5RORyBIT+G6oFQgxJDhu5hORycsCiAgREVMRVRFRDogJ8SQw4MgWMOTQScKfTsKCnZhciBFZGl0UGVybWlzc2lvbkdyb3VwcyA9IGZ1bmN0aW9uIEVkaXRQZXJtaXNzaW9uR3JvdXBzKHByb3BzKSB7CiAgdmFyIF91c2VTZWxlY3RvciA9IHVzZVNlbGVjdG9yKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgcmV0dXJuIHN0YXRlLnBlcm1pc3Npb247CiAgfSksCiAgICAgIGluaXRpYWxTdGF0ZSA9IF91c2VTZWxlY3Rvci5pbml0aWFsU3RhdGU7CgogIHZhciBjaGVja2JveFJlZiA9IHVzZVJlZigpOwogIHZhciBkaXNwYXRjaCA9IHVzZURpc3BhdGNoKCk7CiAgdmFyIGhpc3RvcnkgPSB1c2VIaXN0b3J5KCk7CgogIHZhciBfdXNlU3RhdGUgPSB1c2VTdGF0ZSh7fSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBjaGVja2JveCA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldENoZWNrYm94ID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTMgPSB1c2VTdGF0ZShbXSksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgc2VsZWN0ZWRQZXJtaXNzaW9uID0gX3VzZVN0YXRlNFswXSwKICAgICAgc2V0U2VsZWN0ZWRQZXJtaXNzaW9uID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIHNlbGVjdEJ5SWQgPSBnbG9iYWxpemVkUGVybWlzc2lvbkdyb3Vwc1NlbGVjdG9ycy5zZWxlY3RCeUlkOwogIHZhciBwZXJHcm91cCA9IHVzZVNlbGVjdG9yKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgcmV0dXJuIHNlbGVjdEJ5SWQoc3RhdGUsIHByb3BzLm1hdGNoLnBhcmFtcy5pZCk7CiAgfSk7CgogIHZhciBfdXNlU3RhdGU1ID0gdXNlU3RhdGUobnVsbCksCiAgICAgIF91c2VTdGF0ZTYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU1LCAyKSwKICAgICAgaW5pdFZhbHVlcyA9IF91c2VTdGF0ZTZbMF0sCiAgICAgIHNldEluaXRWYWx1ZXMgPSBfdXNlU3RhdGU2WzFdOwoKICB2YXIgaW5pdGlhbFZhbHVlcyA9IHsKICAgIG5hbWU6ICcnLAogICAgbm90ZTogJycKICB9OwogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBkaXNwYXRjaChnZXREZXRhaWxQZXJtaXNzaW9uR3JvdXBzKHByb3BzLm1hdGNoLnBhcmFtcy5pZCkpOwogICAgZGlzcGF0Y2goZ2V0UGVybWlzc2lvblR5cGUoKSk7CiAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICBkaXNwYXRjaChyZXNldCgpKTsKICAgIH07CiAgfSwgW10pOwogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBzZXRJbml0VmFsdWVzKHBlckdyb3VwKTsKICAgIGNvbnNvbGUubG9nKHBlckdyb3VwKTsKCiAgICBpZiAocGVyR3JvdXAgJiYgcGVyR3JvdXAucGVybWlzc2lvbkdyb3VwQXNzb2NpYXRlcykgewogICAgICB2YXIgZ3JvdXAgPSBwZXJHcm91cC5wZXJtaXNzaW9uR3JvdXBBc3NvY2lhdGVzLnJlZHVjZShmdW5jdGlvbiAociwgYSkgewogICAgICAgIHJbYS50eXBlXSA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoclthLnR5cGVdIHx8IFtdKSwgW2FdKTsKICAgICAgICByZXR1cm4gcjsKICAgICAgfSwge30pOwogICAgICB2YXIgZGF0YSA9IE9iamVjdC5rZXlzKGdyb3VwKS5tYXAoZnVuY3Rpb24gKGtleSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0eXBlOiBrZXksCiAgICAgICAgICB0eXBlTmFtZTogZ3JvdXBba2V5XVswXS50eXBlTmFtZSwKICAgICAgICAgIHBlcm1pc3Npb25zOiBncm91cFtrZXldCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIHNldFNlbGVjdGVkUGVybWlzc2lvbihfdG9Db25zdW1hYmxlQXJyYXkoZGF0YSkpOwogICAgfQogIH0sIFtwZXJHcm91cF0pOwoKICB2YXIgb25HZXRQZXJtaXNzaW9uID0gZnVuY3Rpb24gb25HZXRQZXJtaXNzaW9uKHZhbHVlKSB7CiAgICB2YXIgcGFyYW1zID0gewogICAgICB0eXBlOiB2YWx1ZQogICAgfTsKICAgIGRpc3BhdGNoKGdldFBlcm1pc3Npb25zKHBhcmFtcykpOwogIH07CgogIHZhciBvblN1Ym1pdCA9IGZ1bmN0aW9uIG9uU3VibWl0KHZhbHVlcywgX3JlZikgewogICAgdmFyIHJlc2V0Rm9ybSA9IF9yZWYucmVzZXRGb3JtOwogICAgdmFyIGFyclBlcm1pc3Npb24gPSBbXTsKICAgIHZhbHVlcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodmFsdWVzKSk7CiAgICBzZWxlY3RlZFBlcm1pc3Npb24uZm9yRWFjaChmdW5jdGlvbiAoc2VsZWN0UGVyKSB7CiAgICAgIGlmIChzZWxlY3RQZXIucGVybWlzc2lvbnMpIHsKICAgICAgICBhcnJQZXJtaXNzaW9uID0gYXJyUGVybWlzc2lvbi5jb25jYXQoc2VsZWN0UGVyLnBlcm1pc3Npb25zKTsKICAgICAgfQogICAgfSk7CiAgICBpZiAoYXJyUGVybWlzc2lvbi5sZW5ndGggPT09IDApIHJldHVybjsKCiAgICBpZiAoc2VsZWN0ZWRQZXJtaXNzaW9uLm1hcChmdW5jdGlvbiAocGVybWlzc2lvbikgewogICAgICByZXR1cm4gcGVybWlzc2lvbi5wZXJtaXNzaW9uczsKICAgIH0pLnJlZHVjZShmdW5jdGlvbiAocHJldiwgY3VycmVudCkgewogICAgICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShwcmV2KSwgX3RvQ29uc3VtYWJsZUFycmF5KGN1cnJlbnQpKTsKICAgIH0sIFtdKS5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhbHVlcy5wZXJtaXNzaW9ucyA9IGFyclBlcm1pc3Npb247CiAgICBkaXNwYXRjaChmZXRjaGluZygpKTsKICAgIGRpc3BhdGNoKHVwZGF0ZVBlcm1pc3Npb25Hcm91cHModmFsdWVzKSk7CiAgICByZXNldEZvcm0oKTsKICB9OwoKICB2YXIgb25DaGVjayA9IGZ1bmN0aW9uIG9uQ2hlY2soc2V0Q2hlY2tib3hGdW5jLCBjaGVja2JveFZhbHVlKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHsKICAgICAgZS5wZXJzaXN0KCk7CiAgICAgIHNldENoZWNrYm94RnVuYyhmdW5jdGlvbiAocHJldlN0YXRlKSB7CiAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgcHJldlN0YXRlKSwge30sIF9kZWZpbmVQcm9wZXJ0eSh7fSwgZS50YXJnZXQudmFsdWUsICFjaGVja2JveFZhbHVlW2UudGFyZ2V0LnZhbHVlXSkpOwogICAgICB9KTsKICAgIH07CiAgfTsKCiAgdmFyIG9uU2VsZWN0QWxsID0gZnVuY3Rpb24gb25TZWxlY3RBbGwoY2hlY2tlZFZhbHVlKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICB2YXIgY29weUNoZWNrYm94ID0gX29iamVjdFNwcmVhZCh7fSwgY2hlY2tib3gpOwoKICAgICAgT2JqZWN0LmtleXMoY29weUNoZWNrYm94KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBjb3B5Q2hlY2tib3hba2V5XSA9IGNoZWNrZWRWYWx1ZTsKICAgICAgfSk7CiAgICAgIHNldENoZWNrYm94KGNvcHlDaGVja2JveCk7CgogICAgICBpZiAoY2hlY2tib3hSZWYuY3VycmVudCkgewogICAgICAgIGNoZWNrYm94UmVmLmN1cnJlbnQuY2hlY2tlZCA9IGNoZWNrZWRWYWx1ZTsKICAgICAgfQogICAgfTsKICB9OwoKICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkgewogICAgaWYgKGNoZWNrYm94ICYmIGluaXRpYWxTdGF0ZS5wZXJtaXNzaW9ucyAmJiBBcnJheS5pc0FycmF5KGluaXRpYWxTdGF0ZS5wZXJtaXNzaW9ucykgJiYgaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zLmxlbmd0aCA+IDApIHsKICAgICAgdmFyIHNlbGVjdGVkQXJyID0gW107CiAgICAgIE9iamVjdC5rZXlzKGNoZWNrYm94KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBpZiAoY2hlY2tib3hba2V5XSkgewogICAgICAgICAgc2VsZWN0ZWRBcnIucHVzaChrZXkpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGhhbmRsZVNlbGVjdFBlcm1pc3Npb24obnVsbCwgc2VsZWN0ZWRBcnIpOwogICAgfQogIH0sIFtjaGVja2JveF0pOwoKICB2YXIgcmVtb3ZlUGVybWlzc2lvbiA9IGZ1bmN0aW9uIHJlbW92ZVBlcm1pc3Npb24oaW5kZXgpIHsKICAgIHZhciBhcnIgPSBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0ZWRQZXJtaXNzaW9uKTsKCiAgICBhcnIuc3BsaWNlKGluZGV4LCAxKTsKICAgIHNldFNlbGVjdGVkUGVybWlzc2lvbihhcnIpOwogIH07CgogIHZhciBoYW5kbGVTZWxlY3RQZXJtaXNzaW9uID0gZnVuY3Rpb24gaGFuZGxlU2VsZWN0UGVybWlzc2lvbihlLCB2YWx1ZXMpIHsKICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi8KICAgIGlmICh2YWx1ZXMgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7CiAgICAgIHZhciB0eXBlID0gaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zWzBdLnR5cGU7CiAgICAgIHZhciB0eXBlTmFtZSA9IGluaXRpYWxTdGF0ZS5wZXJtaXNzaW9uc1swXS50eXBlTmFtZTsKICAgICAgdmFyIGZvdW5kZWRJbmRleCA9IHNlbGVjdGVkUGVybWlzc2lvbi5maW5kSW5kZXgoZnVuY3Rpb24gKHBlcikgewogICAgICAgIHJldHVybiBwZXIudHlwZSA9PT0gdHlwZTsKICAgICAgfSk7CgogICAgICBpZiAoZm91bmRlZEluZGV4ID4gLTEpIHsKICAgICAgICBzZWxlY3RlZFBlcm1pc3Npb25bZm91bmRlZEluZGV4XS5wZXJtaXNzaW9ucyA9IGluaXRpYWxTdGF0ZS5wZXJtaXNzaW9ucy5maWx0ZXIoZnVuY3Rpb24gKHBlcm1pc3Npb24pIHsKICAgICAgICAgIHJldHVybiB2YWx1ZXMuaW5jbHVkZXMocGVybWlzc2lvbi5pZCk7CiAgICAgICAgfSk7CiAgICAgICAgc2V0U2VsZWN0ZWRQZXJtaXNzaW9uKF90b0NvbnN1bWFibGVBcnJheShzZWxlY3RlZFBlcm1pc3Npb24pKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgc2VsZWN0ZWRQZXJtaXNzaW9uT2JqID0gewogICAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICAgIHR5cGVOYW1lOiB0eXBlTmFtZSwKICAgICAgICAgIHBlcm1pc3Npb25zOiBpbml0aWFsU3RhdGUucGVybWlzc2lvbnMuZmlsdGVyKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZXMuaW5jbHVkZXMocGVybWlzc2lvbi5pZCk7CiAgICAgICAgICB9KQogICAgICAgIH07CiAgICAgICAgc2V0U2VsZWN0ZWRQZXJtaXNzaW9uKFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0ZWRQZXJtaXNzaW9uKSwgW3NlbGVjdGVkUGVybWlzc2lvbk9ial0pKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh2YWx1ZXMgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPT0gMCkgewogICAgICBzZXRTZWxlY3RlZFBlcm1pc3Npb24odmFsdWVzKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBhcnIgPSBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0ZWRQZXJtaXNzaW9uKTsKCiAgICAgIHZhciBmaW5kRW1wdHkgPSBhcnIuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0ucGVybWlzc2lvbnMubGVuZ3RoID09PSAwOwogICAgICB9KTsKICAgICAgaWYgKGZpbmRFbXB0eSA+IC0xKSBhcnIuc3BsaWNlKGZpbmRFbXB0eSwgMSk7CiAgICAgIHNldFNlbGVjdGVkUGVybWlzc2lvbihhcnIpOwogICAgfQogIH07CgogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBpZiAoaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zICYmIEFycmF5LmlzQXJyYXkoaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zKSkgewogICAgICB2YXIgdGVtcFBlciA9IHt9OwogICAgICBpbml0aWFsU3RhdGUucGVybWlzc2lvbnMuZm9yRWFjaChmdW5jdGlvbiAocGVyKSB7CiAgICAgICAgdGVtcFBlcltwZXIuaWRdID0gZmFsc2U7CiAgICAgIH0pOwogICAgICBzZXRDaGVja2JveCh0ZW1wUGVyKTsKICAgIH0KICB9LCBbaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zXSk7CiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHsKICAgIGlmIChpbml0aWFsU3RhdGUudXBkYXRpbmdTdWNjZXNzKSB7CiAgICAgIGRpc3BhdGNoKHJlc2V0KCkpOwogICAgICBoaXN0b3J5LmdvQmFjaygpOwogICAgfQogIH0sIFtpbml0aWFsU3RhdGUudXBkYXRpbmdTdWNjZXNzXSk7CiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDYXJkLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQ2FyZEhlYWRlciwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NhcmRUaXRsZSwgewogICAgY2xhc3NOYW1lOiAiY2FyZC10aXRsZSBtYi0wIgogIH0sICJUaFx4RUFtIG1cdTFFREJpIG5oXHhGM20gcXV5XHUxRUMxbiIpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NhcmRCb2R5LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtaWssIHsKICAgIGluaXRpYWxWYWx1ZXM6IGluaXRWYWx1ZXMgfHwgaW5pdGlhbFZhbHVlcywKICAgIGVuYWJsZVJlaW5pdGlhbGl6ZTogdHJ1ZSwKICAgIHZhbGlkYXRlOiB2YWxpZGF0ZSh2YWxpZGF0aW9uU2NoZW1hKSwKICAgIG9uU3VibWl0OiBvblN1Ym1pdAogIH0sIGZ1bmN0aW9uIChfcmVmMikgewogICAgdmFyIHZhbHVlcyA9IF9yZWYyLnZhbHVlcywKICAgICAgICBlcnJvcnMgPSBfcmVmMi5lcnJvcnMsCiAgICAgICAgaGFuZGxlQ2hhbmdlID0gX3JlZjIuaGFuZGxlQ2hhbmdlLAogICAgICAgIGhhbmRsZUJsdXIgPSBfcmVmMi5oYW5kbGVCbHVyLAogICAgICAgIGhhbmRsZVN1Ym1pdCA9IF9yZWYyLmhhbmRsZVN1Ym1pdCwKICAgICAgICBoYW5kbGVSZXNldCA9IF9yZWYyLmhhbmRsZVJlc2V0OwogICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENGb3JtLCB7CiAgICAgIG9uU3VibWl0OiBoYW5kbGVTdWJtaXQsCiAgICAgIG5vVmFsaWRhdGU6IHRydWUsCiAgICAgIG5hbWU6ICJzaW1wbGVGb3JtIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBsZzogIjEyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0Zvcm1Hcm91cCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0xhYmVsLCB7CiAgICAgIGh0bWxGb3I6ICJsb2dpbiIKICAgIH0sICJUXHhFQW4gbmhceEYzbSBxdXlcdTFFQzFuIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENJbnB1dCwgewogICAgICB0eXBlOiAidGV4dCIsCiAgICAgIG5hbWU6ICJuYW1lIiwKICAgICAgaWQ6ICJuYW1lIiwKICAgICAgcGxhY2Vob2xkZXI6ICJUXHhFQW4gbmhceEYzbSBxdXlcdTFFQzFuIiwKICAgICAgb25DaGFuZ2U6IGhhbmRsZUNoYW5nZSwKICAgICAgb25CbHVyOiBoYW5kbGVCbHVyLAogICAgICB2YWx1ZTogdmFsdWVzLm5hbWUKICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSW52YWxpZEZlZWRiYWNrLCB7CiAgICAgIGNsYXNzTmFtZTogImQtYmxvY2siCiAgICB9LCBlcnJvcnMubmFtZSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBsZzogIjEyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0Zvcm1Hcm91cCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0xhYmVsLCB7CiAgICAgIGh0bWxGb3I6ICJ1c2VyTmFtZSIKICAgIH0sICJDaFx1MUVDRG4gbmhceEYzbSBjaFx1MUVFOWMgblx1MDEwM25nIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFNlbGVjdCwgewogICAgICBuYW1lOiAiZGVwYXJ0bWVudCIsCiAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7CiAgICAgICAgb25HZXRQZXJtaXNzaW9uKGUudmFsdWUpOwogICAgICB9LAogICAgICBwbGFjZWhvbGRlcjogIkNoXHUxRUNEbiBuaFx4RjNtIGNoXHUxRUU5YyBuXHUwMTAzbmciLAogICAgICBvcHRpb25zOiBpbml0aWFsU3RhdGUucGVybWlzc2lvblR5cGVzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB2YWx1ZTogaXRlbS5uYW1lLAogICAgICAgICAgbGFiZWw6IGl0ZW0uZGVzY3JpcHRpb24KICAgICAgICB9OwogICAgICB9KQogICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBsZzogIjEyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0Zvcm1Hcm91cCwgewogICAgICBjb2x1bW46IHRydWUKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENSb3csIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgY2xhc3NOYW1lOiAibWItMiIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENMYWJlbCwgbnVsbCwgIkNoXHUxRUU5YyBuXHUwMTAzbmciKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgY2xhc3NOYW1lOiAibWItMiIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENCdXR0b25Hcm91cCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICBjb2xvcjogInNlY29uZGFyeSIsCiAgICAgIG9uQ2xpY2s6IG9uU2VsZWN0QWxsKHRydWUpCiAgICB9LCAiQ2hcdTFFQ0RuIHRcdTFFQTV0IGNcdTFFQTMiKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICBjb2xvcjogInNlY29uZGFyeSIsCiAgICAgIG9uQ2xpY2s6IG9uU2VsZWN0QWxsKGZhbHNlKQogICAgfSwgIkJcdTFFQ0YgY2hcdTFFQ0RuIHRcdTFFQTV0IGNcdTFFQTMiKSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBtZDogIjkiCiAgICB9LCBpbml0aWFsU3RhdGUucGVybWlzc2lvbnMgJiYgaW5pdGlhbFN0YXRlLnBlcm1pc3Npb25zLm1hcChmdW5jdGlvbiAoZW50aXR5KSB7CiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDRm9ybUdyb3VwLCB7CiAgICAgICAgdmFyaWFudDogImNoZWNrYm94IiwKICAgICAgICBjbGFzc05hbWU6ICJtYi0yIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSW5wdXRDaGVja2JveCwgewogICAgICAgIGNsYXNzTmFtZTogImZvcm0tY2hlY2staW5wdXQiLAogICAgICAgIGlkOiBlbnRpdHkuaWQsCiAgICAgICAgY2hlY2tlZDogY2hlY2tib3hbZW50aXR5LmlkXSwKICAgICAgICBvbkNoYW5nZTogb25DaGVjayhzZXRDaGVja2JveCwgY2hlY2tib3gpLAogICAgICAgIG5hbWU6IGVudGl0eS5pZCwKICAgICAgICB2YWx1ZTogZW50aXR5LmlkCiAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDTGFiZWwsIHsKICAgICAgICB2YXJpYW50OiAiY2hlY2tib3giLAogICAgICAgIGh0bWxGb3I6ICJyYWRpbzEiCiAgICAgIH0sIGVudGl0eS5kZXNjcmlwdGlvbikpOwogICAgfSkpKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRhYmxlLCB7CiAgICAgIHJlc3BvbnNpdmU6IHRydWUKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0aGVhZCIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0ciIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0aCIsIHsKICAgICAgY2xhc3NOYW1lOiAiaGFuZCB0ZXh0LXJpZ2h0IGluZGV4LWNvbHVtbiIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIlNUVCIpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRoIiwgewogICAgICBjbGFzc05hbWU6ICJoYW5kIHRleHQtbGVmdCIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIk5oXHhGM20gY2hcdTFFRTljIG5cdTAxMDNuZyIpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRoIiwgewogICAgICBjbGFzc05hbWU6ICJoYW5kIHRleHQtbGVmdCIKICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIkRhbmggc1x4RTFjaCBjaFx1MUVFOWMgblx1MDEwM25nIikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidGgiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsICJUaGFvIHRceEUxYyIpKSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidGJvZHkiLCBudWxsLCBzZWxlY3RlZFBlcm1pc3Npb24ubWFwKGZ1bmN0aW9uIChwZXJtaXNzaW9uLCBpKSB7CiAgICAgIGlmIChwZXJtaXNzaW9uLnBlcm1pc3Npb25zICYmIHBlcm1pc3Npb24ucGVybWlzc2lvbnMubGVuZ3RoID4gMCkgewogICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidHIiLCB7CiAgICAgICAgICBrZXk6IHBlcm1pc3Npb24udHlwZQogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0ZCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogInRleHQtY2VudGVyIgogICAgICAgIH0sIGkgKyAxKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRkIiwgbnVsbCwgcGVybWlzc2lvbi50eXBlTmFtZSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0ZCIsIG51bGwsIHBlcm1pc3Npb24ucGVybWlzc2lvbnMgPyBwZXJtaXNzaW9uLnBlcm1pc3Npb25zLm1hcChmdW5jdGlvbiAocGVyKSB7CiAgICAgICAgICByZXR1cm4gcGVyLmRlc2NyaXB0aW9uOwogICAgICAgIH0pLmpvaW4oJyAtLSAnKSA6ICcnKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRkIiwgewogICAgICAgICAgY2xhc3NOYW1lOiAidGV4dC1jZW50ZXIiCiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICAgICAgdHlwZTogInJlc2V0IiwKICAgICAgICAgIHNpemU6ICJsZyIsCiAgICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICByZXR1cm4gcmVtb3ZlUGVybWlzc2lvbihpKTsKICAgICAgICAgIH0sCiAgICAgICAgICBjbGFzc05hbWU6ICJtbC01IgogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENJY29uLCB7CiAgICAgICAgICBuYW1lOiAiY2lsLWJhbiIKICAgICAgICB9KSkpKTsKICAgICAgfQogICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NvbCwgewogICAgICBsZzogIjEyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0Zvcm1Hcm91cCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0xhYmVsLCB7CiAgICAgIGh0bWxGb3I6ICJsb2dpbiIKICAgIH0sICJHaGkgY2hceEZBIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENUZXh0YXJlYSwgewogICAgICB0eXBlOiAidGV4dGFyZWEiLAogICAgICBuYW1lOiAibm90ZSIsCiAgICAgIGlkOiAibm90ZSIsCiAgICAgIHBsYWNlaG9sZGVyOiAiR2hpIGNoXHhGQSIsCiAgICAgIG9uQ2hhbmdlOiBoYW5kbGVDaGFuZ2UsCiAgICAgIG9uQmx1cjogaGFuZGxlQmx1ciwKICAgICAgdmFsdWU6IHZhbHVlcy5ub3RlCiAgICB9KSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDRm9ybUdyb3VwLCB7CiAgICAgIGNsYXNzTmFtZTogImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgICB0eXBlOiAic3VibWl0IiwKICAgICAgc2l6ZTogImxnIiwKICAgICAgY29sb3I6ICJwcmltYXJ5IiwKICAgICAgZGlzYWJsZWQ6IGluaXRpYWxTdGF0ZS5sb2FkaW5nCiAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSWNvbiwgewogICAgICBuYW1lOiAiY2lsLXNhdmUiCiAgICB9KSwgIiAiLCBpbml0aWFsU3RhdGUubG9hZGluZyA/ICfEkGFuZyB44butIGzDvScgOiAnTMawdScpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQnV0dG9uLCB7CiAgICAgIHR5cGU6ICJyZXNldCIsCiAgICAgIHNpemU6ICJsZyIsCiAgICAgIGNvbG9yOiAiZGFuZ2VyIiwKICAgICAgb25DbGljazogaGFuZGxlUmVzZXQsCiAgICAgIGNsYXNzTmFtZTogIm1sLTUiCiAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSWNvbiwgewogICAgICBuYW1lOiAiY2lsLWJhbiIKICAgIH0pLCAiIFhceEYzYSBuaFx1MUVBRHAgbGlcdTFFQzd1IikpKTsKICB9KSkpOwp9OwoKZXhwb3J0IGRlZmF1bHQgRWRpdFBlcm1pc3Npb25Hcm91cHM7"},{"version":3,"sources":["/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/user/UserPermission/edit-permission.js"],"names":["React","useEffect","useRef","useState","CButton","CCard","CCardHeader","CCardBody","CCol","CForm","CInvalidFeedback","CFormGroup","CLabel","CInput","CRow","CCardTitle","CInputCheckbox","CButtonGroup","CTextarea","CIcon","Formik","Yup","useDispatch","useSelector","getDetailPermissionGroups","getPermissions","getPermissionType","updatePermissionGroups","useHistory","fetching","globalizedPermissionGroupsSelectors","reset","Select","Table","validationSchema","object","shape","name","string","min","required","validate","mappingStatus","ACTIVE","INACTIVE","DELETED","EditPermissionGroups","props","state","permission","initialState","checkboxRef","dispatch","history","checkbox","setCheckbox","selectedPermission","setSelectedPermission","selectById","perGroup","match","params","id","initValues","setInitValues","initialValues","note","console","log","permissionGroupAssociates","group","reduce","r","a","type","data","Object","keys","map","key","typeName","permissions","onGetPermission","value","onSubmit","values","resetForm","arrPermission","JSON","parse","stringify","forEach","selectPer","concat","length","prev","current","onCheck","setCheckboxFunc","checkboxValue","e","persist","prevState","target","onSelectAll","checkedValue","copyCheckbox","checked","Array","isArray","selectedArr","push","handleSelectPermission","removePermission","index","arr","splice","foundedIndex","findIndex","per","filter","includes","selectedPermissionObj","findEmpty","item","tempPer","updatingSuccess","goBack","errors","handleChange","handleBlur","handleSubmit","handleReset","permissionTypes","label","description","entity","i","join","loading"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\nimport {\n  CButton,\n  CCard,\n  CCardHeader,\n  CCardBody,\n  CCol,\n  CForm,\n  CInvalidFeedback,\n  CFormGroup,\n  CLabel,\n  CInput,\n  CRow,\n\n  CCardTitle,\n  CInputCheckbox,\n  CButtonGroup,\n  CTextarea,\n} from '@coreui/react';\nimport CIcon from '@coreui/icons-react';\nimport {Formik} from 'formik';\nimport * as Yup from 'yup';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {\n\n  getDetailPermissionGroups,\n  getPermissions,\n  getPermissionType,\n  updatePermissionGroups,\n} from './permission.api';\n\n\nimport {useHistory} from 'react-router-dom';\nimport {fetching, globalizedPermissionGroupsSelectors, reset} from './permission.reducer';\nimport Select from 'react-select';\nimport {Table} from 'reactstrap';\n\nconst validationSchema = function() {\n  return Yup.object().shape({\n    name: Yup.string()\n        .min(5 `Tên nhóm quyền phải lớn hơn 5 kí tự`)\n        .required('Tên nhóm quyền không để trống'),\n  });\n};\n\nimport {validate} from '../../../../shared/utils/normalize';\n\n\nexport const mappingStatus = {\n  ACTIVE: 'ĐANG HOẠT ĐỘNG',\n  INACTIVE: 'KHÔNG HOẠT ĐỘNG',\n  DELETED: 'ĐÃ XÓA',\n};\n\n\nconst EditPermissionGroups = (props) => {\n  const {initialState} = useSelector((state) => state.permission);\n  const checkboxRef = useRef();\n\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const [checkbox, setCheckbox] = useState({});\n  const [selectedPermission, setSelectedPermission] = useState([]);\n  const {selectById} = globalizedPermissionGroupsSelectors;\n  const perGroup = useSelector((state) => selectById(state, props.match.params.id));\n\n  const [initValues, setInitValues] = useState(null);\n\n  const initialValues = {\n    name: '',\n    note: '',\n  };\n\n  useEffect(() => {\n    dispatch(getDetailPermissionGroups(props.match.params.id));\n    dispatch(getPermissionType());\n    return () => {\n      dispatch(reset());\n    };\n  }, []);\n\n  useEffect(() => {\n    setInitValues(perGroup);\n    console.log(perGroup);\n    if (perGroup && perGroup.permissionGroupAssociates) {\n      const group = perGroup.permissionGroupAssociates.reduce((r, a) => {\n        r[a.type] = [...(r[a.type] || []), a];\n        return r;\n      }, {});\n      const data = Object.keys(group).map((key) => ({\n        type: key,\n        typeName: group[key][0].typeName,\n        permissions: group[key],\n      }));\n      setSelectedPermission([...data]);\n    }\n  }, [perGroup]);\n\n  const onGetPermission = (value) => {\n    const params = {type: value};\n    dispatch(getPermissions(params));\n  };\n\n  const onSubmit = (values, {resetForm}) => {\n    let arrPermission = [];\n    values = JSON.parse(JSON.stringify(values));\n    selectedPermission.forEach((selectPer) => {\n      if (selectPer.permissions) {\n        arrPermission = arrPermission.concat(selectPer.permissions);\n      }\n    });\n    if (arrPermission.length === 0) return;\n    if (selectedPermission.map((permission) => permission.permissions).reduce((prev, current) => [...prev, ...current], []).length === 0) {\n      return;\n    }\n    values.permissions = arrPermission;\n\n    dispatch(fetching());\n    dispatch(updatePermissionGroups(values));\n    resetForm();\n  };\n\n  const onCheck = (setCheckboxFunc, checkboxValue) => {\n    return (e) => {\n      e.persist();\n      setCheckboxFunc((prevState) => ({...prevState, [e.target.value]: !checkboxValue[e.target.value]}));\n    };\n  };\n\n  const onSelectAll = (checkedValue) => () => {\n    const copyCheckbox = {...checkbox};\n    Object.keys(copyCheckbox).forEach((key) => {\n      copyCheckbox[key] = checkedValue;\n    });\n    setCheckbox(copyCheckbox);\n    if (checkboxRef.current) {\n      checkboxRef.current.checked = checkedValue;\n    }\n  };\n\n  useEffect(() => {\n    if (checkbox && initialState.permissions && Array.isArray(initialState.permissions) && initialState.permissions.length > 0) {\n      const selectedArr = [];\n      Object.keys(checkbox).forEach((key) => {\n        if (checkbox[key]) {\n          selectedArr.push(key);\n        }\n      });\n      handleSelectPermission(null, selectedArr);\n    }\n  }, [checkbox]);\n\n  const removePermission = (index) => {\n    const arr = [...selectedPermission];\n    arr.splice(index, 1);\n    setSelectedPermission(arr);\n  };\n\n  const handleSelectPermission = (e, values) => {\n    /* eslint-disable no-console */\n    if (values && Array.isArray(values) && values.length > 0) {\n      const type = initialState.permissions[0].type;\n      const typeName = initialState.permissions[0].typeName;\n      const foundedIndex = selectedPermission.findIndex((per) => per.type === type);\n      if (foundedIndex > -1) {\n        selectedPermission[foundedIndex].permissions = initialState.permissions.filter((permission) => values.includes(permission.id));\n        setSelectedPermission([...selectedPermission]);\n      } else {\n        const selectedPermissionObj = {\n          type,\n          typeName,\n          permissions: initialState.permissions.filter((permission) => values.includes(permission.id)),\n        };\n\n        setSelectedPermission([...selectedPermission, selectedPermissionObj]);\n      }\n    } else if (values && Array.isArray(values) && values.length == 0) {\n      setSelectedPermission(values);\n    } else {\n      const arr = [...selectedPermission];\n      const findEmpty = arr.findIndex((item) => item.permissions.length === 0);\n      if (findEmpty > -1) arr.splice(findEmpty, 1);\n      setSelectedPermission(arr);\n    }\n  };\n\n  useEffect(() => {\n    if (initialState.permissions && Array.isArray(initialState.permissions)) {\n      const tempPer = {};\n      initialState.permissions.forEach((per) => {\n        tempPer[per.id] = false;\n      });\n      setCheckbox(tempPer);\n    }\n  }, [initialState.permissions]);\n\n  useEffect(() => {\n    if (initialState.updatingSuccess) {\n      dispatch(reset());\n      history.goBack();\n    }\n  }, [initialState.updatingSuccess]);\n\n  return (\n    <CCard>\n      <CCardHeader>\n        <CCardTitle className=\"card-title mb-0\">Thêm mới nhóm quyền</CCardTitle>\n      </CCardHeader>\n      <CCardBody>\n        <Formik initialValues={initValues || initialValues} enableReinitialize validate={validate(validationSchema)} onSubmit={onSubmit}>\n          {({\n            values,\n            errors,\n\n\n            handleChange,\n            handleBlur,\n            handleSubmit,\n\n\n            handleReset\n            ,\n          }) => (\n            <CForm onSubmit={handleSubmit} noValidate name=\"simpleForm\">\n              <CCol lg=\"12\">\n                <CFormGroup>\n                  <CLabel htmlFor=\"login\">Tên nhóm quyền</CLabel>\n                  <CInput\n                    type=\"text\"\n                    name=\"name\"\n                    id=\"name\"\n                    placeholder=\"Tên nhóm quyền\"\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    value={values.name}\n                  />\n                  <CInvalidFeedback className=\"d-block\">{errors.name}</CInvalidFeedback>\n                </CFormGroup>\n              </CCol>\n              <CCol lg=\"12\">\n                <CFormGroup>\n                  <CLabel htmlFor=\"userName\">Chọn nhóm chức năng</CLabel>\n                  <Select\n                    name=\"department\"\n                    onChange={(e) => {\n                      onGetPermission(e.value);\n                    }}\n                    placeholder=\"Chọn nhóm chức năng\"\n                    options={initialState.permissionTypes.map((item) => ({\n                      value: item.name,\n                      label: item.description,\n                    }))}\n                  />\n                </CFormGroup>\n              </CCol>\n              <CCol lg=\"12\">\n                <CFormGroup column>\n                  <CRow>\n                    <CCol className=\"mb-2\">\n                      <CLabel>Chức năng</CLabel>\n                    </CCol>\n                    <CCol className=\"mb-2\">\n                      <CButtonGroup>\n                        <CButton color=\"secondary\" onClick={onSelectAll(true)}>\n                          Chọn tất cả\n                        </CButton>\n                        <CButton color=\"secondary\" onClick={onSelectAll(false)}>\n                          Bỏ chọn tất cả\n                        </CButton>\n                      </CButtonGroup>\n                    </CCol>\n                  </CRow>\n                  <CCol md=\"9\">\n                    {initialState.permissions &&\n                      initialState.permissions.map((entity) => {\n                        return (\n                          <CFormGroup variant=\"checkbox\" className=\"mb-2\">\n                            <CInputCheckbox\n                              className=\"form-check-input\"\n                              id={entity.id}\n                              checked={checkbox[entity.id]}\n                              onChange={onCheck(setCheckbox, checkbox)}\n                              name={entity.id}\n                              value={entity.id}\n                            />\n                            <CLabel variant=\"checkbox\" htmlFor=\"radio1\">\n                              {entity.description}\n                            </CLabel>\n                          </CFormGroup>\n                        );\n                      })}\n                  </CCol>\n                </CFormGroup>\n              </CCol>\n              <Table responsive>\n                <thead>\n                  <tr>\n                    <th className=\"hand text-right index-column\">\n                      <span>STT</span>\n                    </th>\n                    <th className=\"hand text-left\">\n                      <span>Nhóm chức năng</span>\n                    </th>\n                    <th className=\"hand text-left\">\n                      <span>Danh sách chức năng</span>\n                    </th>\n                    <th>\n                      <span>Thao tác</span>\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {selectedPermission.map((permission, i) => {\n                    if (permission.permissions && permission.permissions.length > 0) {\n                      return (\n                        <tr key={permission.type}>\n                          <td className=\"text-center\">{i + 1}</td>\n                          <td>{permission.typeName}</td>\n                          <td>{permission.permissions ? permission.permissions.map((per) => per.description).join(' -- ') : ''}</td>\n                          <td className=\"text-center\">\n                            <CButton type=\"reset\" size=\"lg\" color=\"danger\" onClick={() => removePermission(i)} className=\"ml-5\">\n                              <CIcon name=\"cil-ban\" />\n                            </CButton>\n                          </td>\n                        </tr>\n                      );\n                    }\n                  })}\n                </tbody>\n              </Table>\n              <CCol lg=\"12\">\n                <CFormGroup>\n                  <CLabel htmlFor=\"login\">Ghi chú</CLabel>\n                  <CTextarea\n                    type=\"textarea\"\n                    name=\"note\"\n                    id=\"note\"\n                    placeholder=\"Ghi chú\"\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    value={values.note}\n                  />\n                </CFormGroup>\n              </CCol>\n              <CFormGroup className=\"d-flex justify-content-center\">\n                <CButton type=\"submit\" size=\"lg\" color=\"primary\" disabled={initialState.loading}>\n                  <CIcon name=\"cil-save\" /> {initialState.loading ? 'Đang xử lý' : 'Lưu'}\n                </CButton>\n                <CButton type=\"reset\" size=\"lg\" color=\"danger\" onClick={handleReset} className=\"ml-5\">\n                  <CIcon name=\"cil-ban\" /> Xóa nhập liệu\n                </CButton>\n              </CFormGroup>\n            </CForm>\n          )}\n        </Formik>\n      </CCardBody>\n    </CCard>\n  );\n};\n\nexport default EditPermissionGroups;\n"]}]}