{"remainingRequest":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/thread-loader/dist/cjs.js??ref--4-2!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/babel-loader/lib/index.js??ref--4-3!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/source-map-loader/index.js!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/eslint-loader/dist/cjs.js!/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/sales/Promotion/Promotions.js","dependencies":[{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/sales/Promotion/Promotions.js","mtime":1624102389104},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/react-hot-loader/webpack.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/source-map-loader/index.js","mtime":499162500000},{"path":"/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/node_modules/eslint-loader/dist/cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJ1bmRlZmluZWQiIHx8ICEoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSkgcmV0dXJuOyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgppbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgQ0NhcmRCb2R5LCBDQmFkZ2UsIENCdXR0b24sIENDb2xsYXBzZSwgQ0RhdGFUYWJsZSwgQ0NhcmQsIENDYXJkSGVhZGVyLCBDUm93LCBDQ29sLCBDUGFnaW5hdGlvbiwgQ01vZGFsLCBDTW9kYWxCb2R5LCBDTW9kYWxGb290ZXIsIENNb2RhbEhlYWRlciwgQ01vZGFsVGl0bGUgfSBmcm9tICdAY29yZXVpL3JlYWN0L2xpYic7IC8vIGltcG9ydCB1c2Vyc0RhdGEgZnJvbSAnLi4vLi4vLi4vdXNlcnMvVXNlcnNEYXRhLmpzJzsKCmltcG9ydCBDSWNvbiBmcm9tICdAY29yZXVpL2ljb25zLXJlYWN0L2xpYi9DSWNvbic7CmltcG9ydCB7IHVzZURpc3BhdGNoLCB1c2VTZWxlY3RvciB9IGZyb20gJ3JlYWN0LXJlZHV4JzsKaW1wb3J0IHsgZ2V0UHJvbW90aW9uLCB1cGRhdGVQcm9tb3Rpb24gfSBmcm9tICcuL3Byb21vdGlvbi5hcGkuanMnOwppbXBvcnQgeyBnbG9iYWxpemVkUHJvbW90aW9uU2VsZWN0b3JzLCByZXNldCB9IGZyb20gJy4vcHJvbW90aW9uLnJlZHVjZXIuanMnOwppbXBvcnQgeyB1c2VIaXN0b3J5IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7CmltcG9ydCB7IHVzZXJTYWZlU2VsZWN0b3IgfSBmcm9tICcuLi8uLi9sb2dpbi9hdXRoZW50aWNhdGUucmVkdWNlci5qcyc7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKdmFyIHNlbGVjdEFsbCA9IGdsb2JhbGl6ZWRQcm9tb3Rpb25TZWxlY3RvcnMuc2VsZWN0QWxsOyAvLyBDb2RlCVTDqm4gY2jGsMahbmcgdHLDrG5oIGLDoW4gaMOgbmcJTmfGsOG7nWkgbGnDqm4gbOG6oWMJTsSDbSBTaW5oCcSQaeG7h24gdGhv4bqhaQlOaMOibiB2acOqbiBxdeG6o24gbMO9CUxv4bqhaSBjaMawxqFuZyB0csOsbmggYsOhbiBow6BuZwlQaMOibiBsb+G6oWkJU+G7rWEJVOG6oW8gxJHGoW4KCnZhciBmaWVsZHMgPSBbewogIGtleTogJ29yZGVyJywKICBsYWJlbDogJ1NUVCcsCiAgX3N0eWxlOiB7CiAgICB3aWR0aDogJzElJwogIH0sCiAgZmlsdGVyOiBmYWxzZQp9LCB7CiAga2V5OiAnbmFtZScsCiAgbGFiZWw6ICdUw6puIGNoxrDGoW5nIHRyw6xuaCBiw6FuIGjDoG5nJywKICBfc3R5bGU6IHsKICAgIHdpZHRoOiAnMjAlJwogIH0KfSwgewogIGtleTogJ3R5cGUnLAogIGxhYmVsOiAnTG/huqFpIGNoxrDGoW5nIHRyw6xuaCcsCiAgX3N0eWxlOiB7CiAgICB3aWR0aDogJzE1JScKICB9Cn0sIHsKICBrZXk6ICdzdGFydFRpbWUnLAogIGxhYmVsOiAnVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1JywKICBfc3R5bGU6IHsKICAgIHdpZHRoOiAnMTUlJwogIH0KfSwgewogIGtleTogJ2VuZFRpbWUnLAogIGxhYmVsOiAnVGjhu51pIGdpYW4ga+G6v3QgdGjDumMnLAogIF9zdHlsZTogewogICAgd2lkdGg6ICcxNSUnCiAgfQp9LCB7CiAga2V5OiAnY3VzdG9tZXJUeXBlJywKICBsYWJlbDogJ8SQ4buRaSB0xrDhu6NuZyDDoXAgZOG7pW5nJywKICBfc3R5bGU6IHsKICAgIHdpZHRoOiAnMTUlJwogIH0KfSwgewogIGtleTogJ2lzTG9jaycsCiAgbGFiZWw6ICdUcuG6oW5nIHRow6FpJywKICBfc3R5bGU6IHsKICAgIHdpZHRoOiAnMTAlJwogIH0KfSwgewogIGtleTogJ3Nob3dfZGV0YWlscycsCiAgbGFiZWw6ICcnLAogIF9zdHlsZTogewogICAgd2lkdGg6ICcxMCUnCiAgfSwKICBmaWx0ZXI6IGZhbHNlCn1dOwoKdmFyIGdldEJhZGdlID0gZnVuY3Rpb24gZ2V0QmFkZ2Uoc3RhdHVzKSB7CiAgc3dpdGNoIChzdGF0dXMpIHsKICAgIGNhc2UgZmFsc2U6CiAgICAgIHJldHVybiAnc3VjY2Vzcyc7CgogICAgY2FzZSB0cnVlOgogICAgICByZXR1cm4gJ2Rhbmdlcic7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuICdzdWNjZXNzJzsKICB9Cn07Cgp2YXIgZ2V0QmFkZ2VUeXBlID0gZnVuY3Rpb24gZ2V0QmFkZ2VUeXBlKHN0YXR1cykgewogIHN3aXRjaCAoc3RhdHVzKSB7CiAgICBjYXNlICdTSE9SVFRFUk0nOgogICAgICByZXR1cm4gJ2luZm8nOwoKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAncHJpbWFyeSc7CiAgfQp9OwoKdmFyIFByb21vdGlvbiA9IGZ1bmN0aW9uIFByb21vdGlvbihwcm9wcykgewogIHZhciBfdXNlU3RhdGUgPSB1c2VTdGF0ZShbXSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBfZGV0YWlscyA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldERldGFpbHMgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgc2VsZWN0ZWRQcm8gPSB1c2VSZWYoewogICAgaWQ6IG51bGwsCiAgICBpc0xvY2s6IGZhbHNlCiAgfSk7CgogIHZhciBfdXNlU3RhdGUzID0gdXNlU3RhdGUoZmFsc2UpLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIHByaW1hcnkgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRQcmltYXJ5ID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF91c2VTZWxlY3RvciA9IHVzZVNlbGVjdG9yKHVzZXJTYWZlU2VsZWN0b3IpLAogICAgICBhY2NvdW50ID0gX3VzZVNlbGVjdG9yLmFjY291bnQ7CgogIHZhciBpc0FkbWluID0gYWNjb3VudC5hdXRob3JpdGllcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHJldHVybiBpdGVtID09PSAnUk9MRV9BRE1JTic7CiAgfSkubGVuZ3RoID4gMDsKCiAgdmFyIF91c2VTZWxlY3RvcjIgPSB1c2VTZWxlY3RvcihmdW5jdGlvbiAoc3RhdGUpIHsKICAgIHJldHVybiBzdGF0ZS5wcm9tb3Rpb247CiAgfSksCiAgICAgIGluaXRpYWxTdGF0ZSA9IF91c2VTZWxlY3RvcjIuaW5pdGlhbFN0YXRlOwoKICB2YXIgX3VzZVN0YXRlNSA9IHVzZVN0YXRlKDEpLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIGFjdGl2ZVBhZ2UgPSBfdXNlU3RhdGU2WzBdLAogICAgICBzZXRBY3RpdmVQYWdlID0gX3VzZVN0YXRlNlsxXTsKCiAgdmFyIF91c2VTdGF0ZTcgPSB1c2VTdGF0ZSg1MCksCiAgICAgIF91c2VTdGF0ZTggPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU3LCAyKSwKICAgICAgc2l6ZSA9IF91c2VTdGF0ZThbMF0sCiAgICAgIHNldFNpemUgPSBfdXNlU3RhdGU4WzFdOwoKICB2YXIgcGFyYW1SZWYgPSB1c2VSZWYobnVsbCk7CiAgdmFyIGRpc3BhdGNoID0gdXNlRGlzcGF0Y2goKTsKICB2YXIgaGlzdG9yeSA9IHVzZUhpc3RvcnkoKTsKICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkgewogICAgZGlzcGF0Y2gocmVzZXQoKSk7CiAgfSwgW10pOwogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBkaXNwYXRjaChnZXRQcm9tb3Rpb24oX29iamVjdFNwcmVhZCh7CiAgICAgIHBhZ2U6IGFjdGl2ZVBhZ2UgLSAxLAogICAgICBzaXplOiBzaXplLAogICAgICBzb3J0OiAnY3JlYXRlZERhdGUsREVTQycKICAgIH0sIHBhcmFtUmVmLmN1cnJlbnQpKSk7CiAgfSwgW2FjdGl2ZVBhZ2UsIHNpemVdKTsKICB2YXIgUHJvbW90aW9ucyA9IHVzZVNlbGVjdG9yKHNlbGVjdEFsbCk7CgogIHZhciBjb21wdXRlZEl0ZW1zID0gZnVuY3Rpb24gY29tcHV0ZWRJdGVtcyhpdGVtcykgewogICAgcmV0dXJuIGl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICB2YXIgX2l0ZW0kY3VzdG9tZXJUeXBlLCBfaXRlbSRkZXNjcmlwdGlvbjsKCiAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGl0ZW0pLCB7fSwgewogICAgICAgIGN1c3RvbWVyVHlwZTogKChfaXRlbSRjdXN0b21lclR5cGUgPSBpdGVtLmN1c3RvbWVyVHlwZSkgPT09IG51bGwgfHwgX2l0ZW0kY3VzdG9tZXJUeXBlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaXRlbSRjdXN0b21lclR5cGUubmFtZSkgfHwgJycsCiAgICAgICAgZGVzY3JpcHRpb246ICgoX2l0ZW0kZGVzY3JpcHRpb24gPSBpdGVtLmRlc2NyaXB0aW9uKSA9PT0gbnVsbCB8fCBfaXRlbSRkZXNjcmlwdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2l0ZW0kZGVzY3JpcHRpb24ubGVuZ3RoKSA+IDEwID8gIiIuY29uY2F0KGl0ZW0uZGVzY3JpcHRpb24uc3Vic3RyaW5nKDAsIDI1MCksICIuLi4iKSA6IGl0ZW0uZGVzY3JpcHRpb24sCiAgICAgICAgY3JlYXRlZERhdGU6IG1vbWVudChpdGVtLmNyZWF0ZWREYXRlKS5mb3JtYXQoJ0RELU1NLVlZWVknKQogICAgICB9KTsKICAgIH0pOwogIH07CgogIHZhciB0b2dnbGVEZXRhaWxzID0gZnVuY3Rpb24gdG9nZ2xlRGV0YWlscyhpbmRleCkgewogICAgdmFyIHBvc2l0aW9uID0gX2RldGFpbHMuaW5kZXhPZihpbmRleCk7CgogICAgdmFyIG5ld0RldGFpbHMgPSBfZGV0YWlscy5zbGljZSgpOwoKICAgIGlmIChwb3NpdGlvbiAhPT0gLTEpIHsKICAgICAgbmV3RGV0YWlscy5zcGxpY2UocG9zaXRpb24sIDEpOwogICAgfSBlbHNlIHsKICAgICAgbmV3RGV0YWlscyA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoX2RldGFpbHMpLCBbaW5kZXhdKTsKICAgIH0KCiAgICBzZXREZXRhaWxzKG5ld0RldGFpbHMpOwogIH07CgogIHZhciBjc3ZDb250ZW50ID0gY29tcHV0ZWRJdGVtcyhQcm9tb3Rpb25zKS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHJldHVybiBPYmplY3QudmFsdWVzKGl0ZW0pLmpvaW4oJywnKTsKICB9KS5qb2luKCdcbicpOwogIHZhciBjc3ZDb2RlID0gJ2RhdGE6dGV4dC9jc3Y7Y2hhcnNldD11dGYtOCxTRVA9LCUwQScgKyBlbmNvZGVVUklDb21wb25lbnQoY3N2Q29udGVudCk7CgogIHZhciB0b0NyZWF0ZVByb21vdGlvbiA9IGZ1bmN0aW9uIHRvQ3JlYXRlUHJvbW90aW9uKCkgewogICAgaGlzdG9yeS5wdXNoKCIiLmNvbmNhdChwcm9wcy5tYXRjaC51cmwsICIvbmV3IikpOwogIH07CgogIHZhciB0b0NyZWF0ZUxvbmdUZXJtUHJvbW90aW9uID0gZnVuY3Rpb24gdG9DcmVhdGVMb25nVGVybVByb21vdGlvbigpIHsKICAgIGhpc3RvcnkucHVzaCgiIi5jb25jYXQocHJvcHMubWF0Y2gudXJsLCAiL25ldy9sb25ndGVybSIpKTsKICB9OwoKICB2YXIgdG9FZGl0UHJvbW90aW9uID0gZnVuY3Rpb24gdG9FZGl0UHJvbW90aW9uKHVzZXJJZCkgewogICAgaGlzdG9yeS5wdXNoKCIiLmNvbmNhdChwcm9wcy5tYXRjaC51cmwsICIvIikuY29uY2F0KHVzZXJJZCwgIi9lZGl0IikpOwogIH07CgogIHZhciB0b0VkaXRMb25nVGVybVByb21vdGlvbiA9IGZ1bmN0aW9uIHRvRWRpdExvbmdUZXJtUHJvbW90aW9uKHVzZXJJZCkgewogICAgaGlzdG9yeS5wdXNoKCIiLmNvbmNhdChwcm9wcy5tYXRjaC51cmwsICIvIikuY29uY2F0KHVzZXJJZCwgIi9sb25ndGVybSIpKTsKICB9OwoKICB2YXIgZGVib3VuY2VkU2VhcmNoQ29sdW1uID0gXy5kZWJvdW5jZShmdW5jdGlvbiAodmFsdWUpIHsKICAgIGlmIChPYmplY3Qua2V5cyh2YWx1ZSkubGVuZ3RoID4gMCkgewogICAgICBPYmplY3Qua2V5cyh2YWx1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgaWYgKCF2YWx1ZVtrZXldKSBkZWxldGUgdmFsdWVba2V5XTsKICAgICAgfSk7CiAgICAgIHBhcmFtUmVmLmN1cnJlbnQgPSB2YWx1ZTsKICAgICAgZGlzcGF0Y2goZ2V0T3JkZXIoX29iamVjdFNwcmVhZCh7CiAgICAgICAgcGFnZTogMCwKICAgICAgICBzaXplOiBzaXplLAogICAgICAgIHNvcnQ6ICdjcmVhdGVkRGF0ZSxERVNDJwogICAgICB9LCB2YWx1ZSkpKTsKICAgIH0KICB9LCAzMDApOwoKICB2YXIgb25GaWx0ZXJDb2x1bW4gPSBmdW5jdGlvbiBvbkZpbHRlckNvbHVtbih2YWx1ZSkgewogICAgZGVib3VuY2VkU2VhcmNoQ29sdW1uKHZhbHVlKTsKICB9OwoKICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkgewogICAgaWYgKGluaXRpYWxTdGF0ZS51cGRhdGluZ1N1Y2Nlc3MpIHsKICAgICAgc2V0UHJpbWFyeShmYWxzZSk7CiAgICAgIGRpc3BhdGNoKGdldFByb21vdGlvbigpKTsKICAgICAgZGlzcGF0Y2gocmVzZXQoKSk7CiAgICB9CiAgfSwgW2luaXRpYWxTdGF0ZS51cGRhdGluZ1N1Y2Nlc3NdKTsKCiAgdmFyIGxvY2tQcm9tb3Rpb24gPSBmdW5jdGlvbiBsb2NrUHJvbW90aW9uKCkgewogICAgZGlzcGF0Y2godXBkYXRlUHJvbW90aW9uKHsKICAgICAgaWQ6IHNlbGVjdGVkUHJvLmN1cnJlbnQuaWQsCiAgICAgIGlzTG9jazogIXNlbGVjdGVkUHJvLmN1cnJlbnQuaXNMb2NrCiAgICB9KSk7CiAgfTsKCiAgdmFyIG1lbW9Db21wdXRlZEl0ZW1zID0gUmVhY3QudXNlQ2FsbGJhY2soZnVuY3Rpb24gKGl0ZW1zKSB7CiAgICByZXR1cm4gY29tcHV0ZWRJdGVtcyhpdGVtcyk7CiAgfSwgW10pOwogIHZhciBtZW1vTGlzdGVkID0gUmVhY3QudXNlTWVtbyhmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gbWVtb0NvbXB1dGVkSXRlbXMoUHJvbW90aW9ucyk7CiAgfSwgW1Byb21vdGlvbnNdKTsKICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NhcmQsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDYXJkSGVhZGVyLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDSWNvbiwgewogICAgbmFtZTogImNpbC1ncmlkIgogIH0pLCAiIERhbmggc1x4RTFjaCBjaFx1MDFCMFx1MDFBMW5nIHRyXHhFQ25oIGJceEUxbiBoXHhFMG5nIiwgKGlzQWRtaW4gfHwgYWNjb3VudC5yb2xlLmZpbHRlcihmdW5jdGlvbiAocm9sKSB7CiAgICByZXR1cm4gcm9sLm1ldGhvZCA9PT0gJ1BPU1QnICYmIHJvbC5lbnRpdHkgPT09ICcvYXBpL3Byb21vdGlvbnMnOwogIH0pLmxlbmd0aCA+IDApICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENCdXR0b24sIHsKICAgIGNvbG9yOiAic3VjY2VzcyIsCiAgICB2YXJpYW50OiAib3V0bGluZSIsCiAgICBjbGFzc05hbWU6ICJtbC0zIiwKICAgIG9uQ2xpY2s6IHRvQ3JlYXRlUHJvbW90aW9uCiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0ljb24sIHsKICAgIG5hbWU6ICJjaWwtcGx1cyIKICB9KSwgIiBUaFx4RUFtIG1cdTFFREJpIGNoXHUwMUIwXHUwMUExbmcgdHJceEVDbmggbmdcdTFFQUZuIGhcdTFFQTFuIiksIChpc0FkbWluIHx8IGFjY291bnQucm9sZS5maWx0ZXIoZnVuY3Rpb24gKHJvbCkgewogICAgcmV0dXJuIHJvbC5tZXRob2QgPT09ICdQT1NUJyAmJiByb2wuZW50aXR5ID09PSAnL2FwaS9wcm9tb3Rpb25zJzsKICB9KS5sZW5ndGggPiAwKSAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQnV0dG9uLCB7CiAgICBjb2xvcjogImluZm8iLAogICAgdmFyaWFudDogIm91dGxpbmUiLAogICAgY2xhc3NOYW1lOiAibWwtMyIsCiAgICBvbkNsaWNrOiB0b0NyZWF0ZUxvbmdUZXJtUHJvbW90aW9uCiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0ljb24sIHsKICAgIG5hbWU6ICJjaWwtcGx1cyIKICB9KSwgIiBUaFx4RUFtIG1cdTFFREJpIGNoXHUwMUIwXHUwMUExbmcgdHJceEVDbmggZFx4RTBpIGhcdTFFQTFuIikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQ2FyZEJvZHksIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENCdXR0b24sIHsKICAgIGNvbG9yOiAicHJpbWFyeSIsCiAgICBjbGFzc05hbWU6ICJtYi0yIiwKICAgIGhyZWY6IGNzdkNvZGUsCiAgICBkb3dubG9hZDogImNvcmV1aS10YWJsZS1kYXRhLmNzdiIsCiAgICB0YXJnZXQ6ICJfYmxhbmsiCiAgfSwgIlRcdTFFQTNpIGV4Y2VsICguY3N2KSIpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDRGF0YVRhYmxlLCB7CiAgICBpdGVtczogbWVtb0xpc3RlZCwKICAgIGZpZWxkczogZmllbGRzLAogICAgY29sdW1uRmlsdGVyOiB0cnVlLAogICAgaXRlbXNQZXJQYWdlU2VsZWN0OiB7CiAgICAgIGxhYmVsOiAnU+G7kSBsxrDhu6NuZyB0csOqbiBt4buZdCB0cmFuZycsCiAgICAgIHZhbHVlczogWzUwLCAxMDAsIDE1MCwgMjAwXQogICAgfSwKICAgIGl0ZW1zUGVyUGFnZTogc2l6ZSwKICAgIGhvdmVyOiB0cnVlLAogICAgc29ydGVyOiB0cnVlLAogICAgbm9JdGVtc1ZpZXc6IHsKICAgICAgbm9SZXN1bHRzOiAnS2jDtG5nIHTDrG0gdGjhuqV5IGvhur90IHF14bqjJywKICAgICAgbm9JdGVtczogJ0tow7RuZyBjw7MgZOG7ryBsaeG7h3UnCiAgICB9IC8vIGxvYWRpbmcKICAgIC8vIG9uUm93Q2xpY2s9eyhpdGVtLGluZGV4LGNvbCxlKSA9PiBjb25zb2xlLmxvZyhpdGVtLGluZGV4LGNvbCxlKX0KICAgICwKICAgIG9uUGFnZUNoYW5nZTogZnVuY3Rpb24gb25QYWdlQ2hhbmdlKHZhbCkgewogICAgICByZXR1cm4gY29uc29sZS5sb2coJ25ldyBwYWdlOicsIHZhbCk7CiAgICB9LAogICAgb25QYWdlc0NoYW5nZTogZnVuY3Rpb24gb25QYWdlc0NoYW5nZSh2YWwpIHsKICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCduZXcgcGFnZXM6JywgdmFsKTsKICAgIH0sCiAgICBvblBhZ2luYXRpb25DaGFuZ2U6IGZ1bmN0aW9uIG9uUGFnaW5hdGlvbkNoYW5nZSh2YWwpIHsKICAgICAgcmV0dXJuIHNldFNpemUodmFsKTsKICAgIH0gLy8gb25GaWx0ZXJlZEl0ZW1zQ2hhbmdlPXsodmFsKSA9PiBjb25zb2xlLmxvZygnbmV3IGZpbHRlcmVkIGl0ZW1zOicsIHZhbCl9CiAgICAvLyBvblNvcnRlclZhbHVlQ2hhbmdlPXsodmFsKSA9PiBjb25zb2xlLmxvZygnbmV3IHNvcnRlciB2YWx1ZTonLCB2YWwpfQogICAgLAogICAgb25UYWJsZUZpbHRlckNoYW5nZTogZnVuY3Rpb24gb25UYWJsZUZpbHRlckNoYW5nZSh2YWwpIHsKICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCduZXcgdGFibGUgZmlsdGVyOicsIHZhbCk7CiAgICB9LAogICAgb25Db2x1bW5GaWx0ZXJDaGFuZ2U6IG9uRmlsdGVyQ29sdW1uLAogICAgc2NvcGVkU2xvdHM6IHsKICAgICAgb3JkZXI6IGZ1bmN0aW9uIG9yZGVyKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJ0ZCIsIG51bGwsIChhY3RpdmVQYWdlIC0gMSkgKiBzaXplICsgaW5kZXggKyAxKTsKICAgICAgfSwKICAgICAgaXNMb2NrOiBmdW5jdGlvbiBpc0xvY2soaXRlbSkgewogICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidGQiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQmFkZ2UsIHsKICAgICAgICAgIGNvbG9yOiBnZXRCYWRnZShpdGVtLmlzTG9jaykKICAgICAgICB9LCBpdGVtLmlzTG9jayA/ICfEkMOjIGtow7NhJyA6ICfEkGFuZyBt4bufJykpOwogICAgICB9LAogICAgICB0eXBlOiBmdW5jdGlvbiB0eXBlKGl0ZW0pIHsKICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInRkIiwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0JhZGdlLCB7CiAgICAgICAgICBjb2xvcjogZ2V0QmFkZ2VUeXBlKGl0ZW0udHlwZSkKICAgICAgICB9LCBpdGVtLnR5cGUgPT09ICdTSE9SVFRFUk0nID8gJ05H4bquTiBI4bqgTicgOiAnRMOASSBI4bqgTicpKTsKICAgICAgfSwKICAgICAgc2hvd19kZXRhaWxzOiBmdW5jdGlvbiBzaG93X2RldGFpbHMoaXRlbSkgewogICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgidGQiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJkLWZsZXggcHktMiIKICAgICAgICB9LCAoaXNBZG1pbiB8fCBhY2NvdW50LnJvbGUuZmlsdGVyKGZ1bmN0aW9uIChyb2wpIHsKICAgICAgICAgIHJldHVybiByb2wubWV0aG9kID09PSAnUFVUJyAmJiByb2wuZW50aXR5ID09PSAnL2FwaS9wcm9tb3Rpb25zJzsKICAgICAgICB9KS5sZW5ndGggPiAwKSAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQnV0dG9uLCB7CiAgICAgICAgICBjb2xvcjogInByaW1hcnkiLAogICAgICAgICAgdmFyaWFudDogIm91dGxpbmUiLAogICAgICAgICAgc2hhcGU6ICJzcXVhcmUiLAogICAgICAgICAgc2l6ZTogInNtIiwKICAgICAgICAgIGNsYXNzTmFtZTogIm1yLTMiLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgaXRlbS50eXBlID09PSAnU0hPUlRURVJNJyA/IHRvRWRpdFByb21vdGlvbihpdGVtLmlkKSA6IHRvRWRpdExvbmdUZXJtUHJvbW90aW9uKGl0ZW0uaWQpOwogICAgICAgICAgfQogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENJY29uLCB7CiAgICAgICAgICBuYW1lOiAiY2lsLXBlbmNpbCIKICAgICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENCdXR0b24sIHsKICAgICAgICAgIGNvbG9yOiAicHJpbWFyeSIsCiAgICAgICAgICB2YXJpYW50OiAib3V0bGluZSIsCiAgICAgICAgICBzaGFwZTogInNxdWFyZSIsCiAgICAgICAgICBzaXplOiAic20iLAogICAgICAgICAgY2xhc3NOYW1lOiAibXItMyIsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICB0b2dnbGVEZXRhaWxzKGl0ZW0uaWQpOwogICAgICAgICAgfQogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENJY29uLCB7CiAgICAgICAgICBuYW1lOiAiY2lsWm9vbSIKICAgICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENCdXR0b24sIHsKICAgICAgICAgIGNvbG9yOiAicHJpbWFyeSIsCiAgICAgICAgICB2YXJpYW50OiAib3V0bGluZSIsCiAgICAgICAgICBzaGFwZTogInNxdWFyZSIsCiAgICAgICAgICBzaXplOiAic20iLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgc2VsZWN0ZWRQcm8uY3VycmVudCA9IHsKICAgICAgICAgICAgICBpZDogaXRlbS5pZCwKICAgICAgICAgICAgICBpc0xvY2s6IGl0ZW0uaXNMb2NrCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHNldFByaW1hcnkoIXByaW1hcnkpOwogICAgICAgICAgfQogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENJY29uLCB7CiAgICAgICAgICBuYW1lOiAhaXRlbS5pc0xvY2sgPyAnY2lsTG9ja0xvY2tlZCcgOiAnY2lsTG9ja1VubG9ja2VkJwogICAgICAgIH0pKSk7CiAgICAgIH0sCiAgICAgIGRldGFpbHM6IGZ1bmN0aW9uIGRldGFpbHMoaXRlbSkgewogICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDQ29sbGFwc2UsIHsKICAgICAgICAgIHNob3c6IF9kZXRhaWxzLmluY2x1ZGVzKGl0ZW0uaWQpCiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0NhcmRCb2R5LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaDUiLCBudWxsLCAiVGhceEY0bmcgdGluIG5nXHUwMUIwXHUxRUREaSBkXHhGOW5nIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENSb3csIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgICAgIGxnOiAiNiIKICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGwiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJyb3ciCiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImR0IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXNtLTMiCiAgICAgICAgfSwgIlRceEVBbiBjaFx1MDFCMFx1MDFBMW5nIHRyXHhFQ25oIGJceEUxbiBoXHhFMG5nOiIpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGQiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtc20tOTthNSIKICAgICAgICB9LCBpdGVtLm5hbWUpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRsIiwgewogICAgICAgICAgY2xhc3NOYW1lOiAicm93IgogICAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkdCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zbS0zIgogICAgICAgIH0sICJOZ1x4RTB5IGJcdTFFQUZ0IFx1MDExMVx1MUVBN3U6IiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkZCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zbS05IgogICAgICAgIH0sIGl0ZW0uc3RhcnRUaW1lKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkbCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogInJvdyIKICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZHQiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtc20tMyIKICAgICAgICB9LCAiTmdceEUweSBrXHUxRUJGdCB0aFx4RkFjOiIpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGQiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtc20tOSIKICAgICAgICB9LCBpdGVtLmVuZFRpbWUpKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENDb2wsIHsKICAgICAgICAgIGxnOiAiNiIKICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGwiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJyb3ciCiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImR0IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXNtLTMiCiAgICAgICAgfSwgIlRcdTFFRDVuZyBkb2FuaCB0aHU6IiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkZCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zbS05IgogICAgICAgIH0sIGl0ZW0udG90YWxSZXZlbnVlKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkbCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogInJvdyIKICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZHQiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtc20tMyIKICAgICAgICB9LCAiXHUwMTEwXHUxRUQxaSB0XHUwMUIwXHUxRUUzbmcgXHhFMXAgZFx1MUVFNW5nIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkZCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zbS05IgogICAgICAgIH0sIGl0ZW0uY3VzdG9tZXJUeXBlKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkbCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogInJvdyIKICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZHQiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtc20tMyIKICAgICAgICB9LCAiVHJcdTFFQTFuZyB0aFx4RTFpIiksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkZCIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zbS05IgogICAgICAgIH0sIGl0ZW0uaXNMb2NrID8gJ8SQw6Mga2jDs2EnIDogJ8SQYW5nIG3hu58nKSkpKSkpOwogICAgICB9CiAgICB9CiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENQYWdpbmF0aW9uLCB7CiAgICBhY3RpdmVQYWdlOiBhY3RpdmVQYWdlLAogICAgcGFnZXM6IE1hdGguZmxvb3IoaW5pdGlhbFN0YXRlLnRvdGFsSXRlbSAvIDIwKSArIDEsCiAgICBvbkFjdGl2ZVBhZ2VDaGFuZ2U6IGZ1bmN0aW9uIG9uQWN0aXZlUGFnZUNoYW5nZShpKSB7CiAgICAgIHJldHVybiBzZXRBY3RpdmVQYWdlKGkpOwogICAgfQogIH0pKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ01vZGFsLCB7CiAgICBzaG93OiBwcmltYXJ5LAogICAgb25DbG9zZTogZnVuY3Rpb24gb25DbG9zZSgpIHsKICAgICAgcmV0dXJuIHNldFByaW1hcnkoIXByaW1hcnkpOwogICAgfSwKICAgIGNvbG9yOiAicHJpbWFyeSIKICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDTW9kYWxIZWFkZXIsIHsKICAgIGNsb3NlQnV0dG9uOiB0cnVlCiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ01vZGFsVGl0bGUsIG51bGwsICJLaFx4RjNhIGNoXHUwMUIwXHUwMUExbmcgdHJceEVDbmgiKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENNb2RhbEJvZHksIG51bGwsICJCXHUxRUExbiBjXHhGMyBjaFx1MUVBRmMgY2hcdTFFQUZuIG11XHUxRUQxbiAiLmNvbmNhdChzZWxlY3RlZFByby5jdXJyZW50LmlzTG9jayA/ICdt4bufIGtow7NhJyA6ICdraMOzYScsICIgY2hcdTAxQjBcdTAxQTFuZyB0clx4RUNuaCBuXHhFMHkga2hceEY0bmc/IikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDTW9kYWxGb290ZXIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENCdXR0b24sIHsKICAgIGNvbG9yOiAicHJpbWFyeSIsCiAgICBvbkNsaWNrOiBsb2NrUHJvbW90aW9uCiAgfSwgIlx1MDExMFx1MUVEM25nIFx4RkQiKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ0J1dHRvbiwgewogICAgY29sb3I6ICJzZWNvbmRhcnkiLAogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgcmV0dXJuIHNldFByaW1hcnkoIXByaW1hcnkpOwogICAgfQogIH0sICJIXHUxRUU3eSIpKSkpOwp9OwoKZXhwb3J0IGRlZmF1bHQgUHJvbW90aW9uOw=="},{"version":3,"sources":["/Users/dmr/PrivateProject/Nodejs/MydicoCRM/frontend/src/views/pages/sales/Promotion/Promotions.js"],"names":["React","useCallback","useEffect","useRef","useState","CCardBody","CBadge","CButton","CCollapse","CDataTable","CCard","CCardHeader","CRow","CCol","CPagination","CModal","CModalBody","CModalFooter","CModalHeader","CModalTitle","CIcon","useDispatch","useSelector","getPromotion","updatePromotion","globalizedPromotionSelectors","reset","useHistory","userSafeSelector","_","moment","selectAll","fields","key","label","_style","width","filter","getBadge","status","getBadgeType","Promotion","props","details","setDetails","selectedPro","id","isLock","primary","setPrimary","account","isAdmin","authorities","item","length","state","promotion","initialState","activePage","setActivePage","size","setSize","paramRef","dispatch","history","page","sort","current","Promotions","computedItems","items","map","customerType","name","description","substring","createdDate","format","toggleDetails","index","position","indexOf","newDetails","slice","splice","csvContent","Object","values","join","csvCode","encodeURIComponent","toCreatePromotion","push","match","url","toCreateLongTermPromotion","toEditPromotion","userId","toEditLongTermPromotion","debouncedSearchColumn","debounce","value","keys","forEach","getOrder","onFilterColumn","updatingSuccess","lockPromotion","memoComputedItems","memoListed","useMemo","role","rol","method","entity","noResults","noItems","val","console","log","order","type","show_details","includes","startTime","endTime","totalRevenue","Math","floor","totalItem","i"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport {\n  CCardBody,\n  CBadge,\n  CButton,\n  CCollapse,\n  CDataTable,\n  CCard,\n  CCardHeader,\n  CRow,\n  CCol,\n  CPagination,\n  CModal,\n  CModalBody,\n  CModalFooter,\n  CModalHeader,\n  CModalTitle\n} from '@coreui/react/lib';\n// import usersData from '../../../users/UsersData.js';\nimport CIcon from '@coreui/icons-react/lib/CIcon';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getPromotion, updatePromotion } from './promotion.api.js';\nimport { globalizedPromotionSelectors, reset } from './promotion.reducer.js';\nimport { useHistory } from 'react-router-dom';\nimport { userSafeSelector } from '../../login/authenticate.reducer.js';\nimport _ from 'lodash';\nimport moment from 'moment';\n\nconst { selectAll } = globalizedPromotionSelectors;\n\n// Code\tTên chương trình bán hàng\tNgười liên lạc\tNăm Sinh\tĐiện thoại\tNhân viên quản lý\tLoại chương trình bán hàng\tPhân loại\tSửa\tTạo đơn\nconst fields = [\n  {\n    key: 'order',\n    label: 'STT',\n    _style: { width: '1%' },\n    filter: false\n  },\n  { key: 'name', label: 'Tên chương trình bán hàng', _style: { width: '20%' } },\n  { key: 'type', label: 'Loại chương trình', _style: { width: '15%' } },\n  { key: 'startTime', label: 'Thời gian bắt đầu', _style: { width: '15%' } },\n  { key: 'endTime', label: 'Thời gian kết thúc', _style: { width: '15%' } },\n  { key: 'customerType', label: 'Đối tượng áp dụng', _style: { width: '15%' } },\n  { key: 'isLock', label: 'Trạng thái', _style: { width: '10%' } },\n  {\n    key: 'show_details',\n    label: '',\n    _style: { width: '10%' },\n    filter: false\n  }\n];\n\nconst getBadge = status => {\n  switch (status) {\n    case false:\n      return 'success';\n    case true:\n      return 'danger';\n    default:\n      return 'success';\n  }\n};\n\nconst getBadgeType = status => {\n  switch (status) {\n    case 'SHORTTERM':\n      return 'info';\n    default:\n      return 'primary';\n  }\n};\n\nconst Promotion = props => {\n  const [details, setDetails] = useState([]);\n  const selectedPro = useRef({ id: null, isLock: false });\n  const [primary, setPrimary] = useState(false);\n  const { account } = useSelector(userSafeSelector);\n  const isAdmin = account.authorities.filter(item => item === 'ROLE_ADMIN').length > 0;\n  const { initialState } = useSelector(state => state.promotion);\n  const [activePage, setActivePage] = useState(1);\n  const [size, setSize] = useState(50);\n  const paramRef = useRef(null);\n  const dispatch = useDispatch();\n  const history = useHistory();\n  useEffect(() => {\n    dispatch(reset());\n  }, []);\n\n  useEffect(() => {\n    dispatch(getPromotion({ page: activePage - 1, size: size, sort: 'createdDate,DESC', ...paramRef.current }));\n  }, [activePage, size]);\n\n  const Promotions = useSelector(selectAll);\n  const computedItems = items => {\n    return items.map(item => {\n      return {\n        ...item,\n        customerType: item.customerType?.name || '',\n        description: item.description?.length > 10 ? `${item.description.substring(0, 250)}...` : item.description,\n        createdDate: moment(item.createdDate).format('DD-MM-YYYY')\n      };\n    });\n  };\n  const toggleDetails = index => {\n    const position = details.indexOf(index);\n    let newDetails = details.slice();\n    if (position !== -1) {\n      newDetails.splice(position, 1);\n    } else {\n      newDetails = [...details, index];\n    }\n    setDetails(newDetails);\n  };\n\n  const csvContent = computedItems(Promotions)\n    .map(item => Object.values(item).join(','))\n    .join('\\n');\n  const csvCode = 'data:text/csv;charset=utf-8,SEP=,%0A' + encodeURIComponent(csvContent);\n  const toCreatePromotion = () => {\n    history.push(`${props.match.url}/new`);\n  };\n  const toCreateLongTermPromotion = () => {\n    history.push(`${props.match.url}/new/longterm`);\n  };\n  const toEditPromotion = userId => {\n    history.push(`${props.match.url}/${userId}/edit`);\n  };\n  const toEditLongTermPromotion = userId => {\n    history.push(`${props.match.url}/${userId}/longterm`);\n  };\n\n  const debouncedSearchColumn =  _.debounce(value => {\n      if (Object.keys(value).length > 0) {\n        Object.keys(value).forEach(key => {\n          if (!value[key]) delete value[key];\n        });\n        paramRef.current = value;\n        dispatch(getOrder({ page: 0, size: size, sort: 'createdDate,DESC', ...value }));\n      }\n    }, 300)\n\n  const onFilterColumn = value => {\n    debouncedSearchColumn(value);\n  };\n\n  useEffect(() => {\n    if (initialState.updatingSuccess) {\n      setPrimary(false);\n      dispatch(getPromotion());\n      dispatch(reset());\n    }\n  }, [initialState.updatingSuccess]);\n\n  const lockPromotion = () => {\n    dispatch(updatePromotion({ id: selectedPro.current.id, isLock: !selectedPro.current.isLock }));\n  };\n\n  const memoComputedItems = React.useCallback(items => computedItems(items), []);\n  const memoListed = React.useMemo(() => memoComputedItems(Promotions), [Promotions]);\n\n  return (\n    <CCard>\n      <CCardHeader>\n        <CIcon name=\"cil-grid\" /> Danh sách chương trình bán hàng\n        {(isAdmin || account.role.filter(rol => rol.method === 'POST' && rol.entity === '/api/promotions').length > 0) && (\n          <CButton color=\"success\" variant=\"outline\" className=\"ml-3\" onClick={toCreatePromotion}>\n            <CIcon name=\"cil-plus\" /> Thêm mới chương trình ngắn hạn\n          </CButton>\n        )}\n        {(isAdmin || account.role.filter(rol => rol.method === 'POST' && rol.entity === '/api/promotions').length > 0) && (\n          <CButton color=\"info\" variant=\"outline\" className=\"ml-3\" onClick={toCreateLongTermPromotion}>\n            <CIcon name=\"cil-plus\" /> Thêm mới chương trình dài hạn\n          </CButton>\n        )}\n      </CCardHeader>\n      <CCardBody>\n        <CButton color=\"primary\" className=\"mb-2\" href={csvCode} download=\"coreui-table-data.csv\" target=\"_blank\">\n          Tải excel (.csv)\n        </CButton>\n        <CDataTable\n          items={memoListed}\n          fields={fields}\n          columnFilter\n          itemsPerPageSelect={{ label: 'Số lượng trên một trang', values: [50, 100, 150, 200] }}\n          itemsPerPage={size}\n          hover\n          sorter\n          noItemsView={{\n            noResults: 'Không tìm thấy kết quả',\n            noItems: 'Không có dữ liệu'\n          }}\n          // loading\n          // onRowClick={(item,index,col,e) => console.log(item,index,col,e)}\n          onPageChange={val => console.log('new page:', val)}\n          onPagesChange={val => console.log('new pages:', val)}\n          onPaginationChange={val => setSize(val)}\n          // onFilteredItemsChange={(val) => console.log('new filtered items:', val)}\n          // onSorterValueChange={(val) => console.log('new sorter value:', val)}\n          onTableFilterChange={val => console.log('new table filter:', val)}\n          onColumnFilterChange={onFilterColumn}\n          scopedSlots={{\n            order: (item, index) => <td>{(activePage - 1) * size + index + 1}</td>,\n            isLock: item => (\n              <td>\n                <CBadge color={getBadge(item.isLock)}>{item.isLock ? 'Đã khóa' : 'Đang mở'}</CBadge>\n              </td>\n            ),\n            type: item => (\n              <td>\n                <CBadge color={getBadgeType(item.type)}>{item.type === 'SHORTTERM' ? 'NGẮN HẠN' : 'DÀI HẠN'}</CBadge>\n              </td>\n            ),\n            show_details: item => {\n              return (\n                <td className=\"d-flex py-2\">\n                  {(isAdmin || account.role.filter(rol => rol.method === 'PUT' && rol.entity === '/api/promotions').length > 0) && (\n                    <CButton\n                      color=\"primary\"\n                      variant=\"outline\"\n                      shape=\"square\"\n                      size=\"sm\"\n                      className=\"mr-3\"\n                      onClick={() => {\n                        item.type === 'SHORTTERM' ? toEditPromotion(item.id) : toEditLongTermPromotion(item.id);\n                      }}\n                    >\n                      <CIcon name=\"cil-pencil\" />\n                    </CButton>\n                  )}\n                  <CButton\n                    color=\"primary\"\n                    variant=\"outline\"\n                    shape=\"square\"\n                    size=\"sm\"\n                    className=\"mr-3\"\n                    onClick={() => {\n                      toggleDetails(item.id);\n                    }}\n                  >\n                    <CIcon name=\"cilZoom\" />\n                  </CButton>\n                  <CButton\n                    color=\"primary\"\n                    variant=\"outline\"\n                    shape=\"square\"\n                    size=\"sm\"\n                    onClick={() => {\n                      selectedPro.current = { id: item.id, isLock: item.isLock };\n                      setPrimary(!primary);\n                    }}\n                  >\n                    <CIcon name={!item.isLock ? 'cilLockLocked' : 'cilLockUnlocked'} />\n                  </CButton>\n                </td>\n              );\n            },\n            details: item => {\n              return (\n                <CCollapse show={details.includes(item.id)}>\n                  <CCardBody>\n                    <h5>Thông tin người dùng</h5>\n                    <CRow>\n                      <CCol lg=\"6\">\n                        <dl className=\"row\">\n                          <dt className=\"col-sm-3\">Tên chương trình bán hàng:</dt>\n                          <dd className=\"col-sm-9;a5\">{item.name}</dd>\n                        </dl>\n                        <dl className=\"row\">\n                          <dt className=\"col-sm-3\">Ngày bắt đầu:</dt>\n                          <dd className=\"col-sm-9\">{item.startTime}</dd>\n                        </dl>\n                        <dl className=\"row\">\n                          <dt className=\"col-sm-3\">Ngày kết thúc:</dt>\n                          <dd className=\"col-sm-9\">{item.endTime}</dd>\n                        </dl>\n                      </CCol>\n                      <CCol lg=\"6\">\n                        <dl className=\"row\">\n                          <dt className=\"col-sm-3\">Tổng doanh thu:</dt>\n                          <dd className=\"col-sm-9\">{item.totalRevenue}</dd>\n                        </dl>\n                        <dl className=\"row\">\n                          <dt className=\"col-sm-3\">Đối tượng áp dụng</dt>\n                          <dd className=\"col-sm-9\">{item.customerType}</dd>\n                        </dl>\n                        <dl className=\"row\">\n                          <dt className=\"col-sm-3\">Trạng thái</dt>\n                          <dd className=\"col-sm-9\">{item.isLock ? 'Đã khóa' : 'Đang mở'}</dd>\n                        </dl>\n                      </CCol>\n                    </CRow>\n                  </CCardBody>\n                </CCollapse>\n              );\n            }\n          }}\n        />\n        <CPagination\n          activePage={activePage}\n          pages={Math.floor(initialState.totalItem / 20) + 1}\n          onActivePageChange={i => setActivePage(i)}\n        />\n      </CCardBody>\n      <CModal show={primary} onClose={() => setPrimary(!primary)} color=\"primary\">\n        <CModalHeader closeButton>\n          <CModalTitle>Khóa chương trình</CModalTitle>\n        </CModalHeader>\n        <CModalBody>{`Bạn có chắc chắn muốn ${selectedPro.current.isLock ? 'mở khóa' : 'khóa'} chương trình này không?`}</CModalBody>\n        <CModalFooter>\n          <CButton color=\"primary\" onClick={lockPromotion}>\n            Đồng ý\n          </CButton>\n          <CButton color=\"secondary\" onClick={() => setPrimary(!primary)}>\n            Hủy\n          </CButton>\n        </CModalFooter>\n      </CModal>\n    </CCard>\n  );\n};\n\nexport default Promotion;\n"]}]}